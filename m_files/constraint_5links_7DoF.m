function [jac_c1,jac_c2,gamma_c1,gamma_c2,pFoot1,pFoot2,KE,PE] = constraint_5links_7DoF(q,dq)
% CONSTRAINT_5LINKS_7DOF
%   [JAC_C1,JAC_C2,GAMMA_C1,GAMMA_C2,PFOOT1,PFOOT2,PE,KE] = CONSTRAINT_5LINKS_7DOF(Q,DQ)  return the constrain value.

%Eric Westervelt
%2016 Version: Peter Minh
%01-Dec-2016 16:37:51

modelP;


q31L=q(1);q32L=q(2);q41L=q(3);q42L=q(4);q1L=q(5);ycm=q(6);zcm=q(7);
dq31L=dq(1);dq32L=dq(2);dq41L=dq(3);dq42L=dq(4);dq1L=dq(5);dycm=dq(6);dzcm=dq(7);
jac_c1=zeros(2,7);
jac_c1(1,1)=(M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*cos(q31L + q41L + q1L) - L3*cos(q31L + q1L);
jac_c1(1,2)=(M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4);
jac_c1(1,3)=(M4*(MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*cos(q31L + q41L + q1L);
jac_c1(1,4)=(M4*(MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4);
jac_c1(1,5)=(M1*(MZ1*cos(q1L) + MY1*sin(q1L)) + M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4) - L3*cos(q31L + q1L) - L4*cos(q31L + q41L + q1L);
jac_c1(1,6)=1;
jac_c1(2,1)=(M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) - M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*sin(q31L + q41L + q1L) - L3*sin(q31L + q1L);
jac_c1(2,2)=(M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L)))/(M1 + 2*M3 + 2*M4);
jac_c1(2,3)=- L4*sin(q31L + q41L + q1L) - (M4*(MY4*cos(q31L + q41L + q1L) - MZ4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4);
jac_c1(2,4)=-(M4*(MY4*cos(q32L + q42L + q1L) - MZ4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4);
jac_c1(2,5)=- L3*sin(q31L + q1L) - (M1*(MY1*cos(q1L) - MZ1*sin(q1L)) - M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) + M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L)) + M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*sin(q31L + q41L + q1L);
jac_c1(2,7)=1;
jac_c2=zeros(2,7);
jac_c2(1,1)=(M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4);
jac_c2(1,2)=(M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*cos(q32L + q42L + q1L) - L3*cos(q32L + q1L);
jac_c2(1,3)=(M4*(MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4);
jac_c2(1,4)=(M4*(MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*cos(q32L + q42L + q1L);
jac_c2(1,5)=(M1*(MZ1*cos(q1L) + MY1*sin(q1L)) + M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4) - L3*cos(q32L + q1L) - L4*cos(q32L + q42L + q1L);
jac_c2(1,6)=1;
jac_c2(2,1)=(M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) - M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L)))/(M1 + 2*M3 + 2*M4);
jac_c2(2,2)=(M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*sin(q32L + q42L + q1L) - L3*sin(q32L + q1L);
jac_c2(2,3)=-(M4*(MY4*cos(q31L + q41L + q1L) - MZ4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4);
jac_c2(2,4)=- L4*sin(q32L + q42L + q1L) - (M4*(MY4*cos(q32L + q42L + q1L) - MZ4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4);
jac_c2(2,5)=- L3*sin(q32L + q1L) - (M1*(MY1*cos(q1L) - MZ1*sin(q1L)) - M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) + M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L)) + M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*sin(q32L + q42L + q1L);
jac_c2(2,7)=1;
gamma_c1=zeros(2,1);
gamma_c1(1,1)=dq41L*(dq1L*(L4*sin(q31L + q41L + q1L) + (M4*(MY4*cos(q31L + q41L + q1L) - MZ4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq31L*(L4*sin(q31L + q41L + q1L) + (M4*(MY4*cos(q31L + q41L + q1L) - MZ4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq41L*(L4*sin(q31L + q41L + q1L) + (M4*(MY4*cos(q31L + q41L + q1L) - MZ4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4))) - dq32L*((dq1L*(M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L))))/(M1 + 2*M3 + 2*M4) + (dq32L*(M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L))))/(M1 + 2*M3 + 2*M4) - (M4*dq42L*(MY4*cos(q32L + q42L + q1L) - MZ4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq1L*(dq1L*(L3*sin(q31L + q1L) + (M1*(MY1*cos(q1L) - MZ1*sin(q1L)) - M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) + M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L)) + M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L)))/(M1 + 2*M3 + 2*M4) + L4*sin(q31L + q41L + q1L)) + dq31L*(L3*sin(q31L + q1L) + L4*sin(q31L + q41L + q1L) - (M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) - M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq41L*(L4*sin(q31L + q41L + q1L) + (M4*(MY4*cos(q31L + q41L + q1L) - MZ4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4)) - (dq32L*(M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L))))/(M1 + 2*M3 + 2*M4) + (M4*dq42L*(MY4*cos(q32L + q42L + q1L) - MZ4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq42L*((M4*dq1L*(MY4*cos(q32L + q42L + q1L) - MZ4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4) + (M4*dq32L*(MY4*cos(q32L + q42L + q1L) - MZ4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4) + (M4*dq42L*(MY4*cos(q32L + q42L + q1L) - MZ4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq31L*(dq1L*(L3*sin(q31L + q1L) + L4*sin(q31L + q41L + q1L) - (M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) - M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq31L*(L3*sin(q31L + q1L) + L4*sin(q31L + q41L + q1L) - (M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) - M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq41L*(L4*sin(q31L + q41L + q1L) + (M4*(MY4*cos(q31L + q41L + q1L) - MZ4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4)));
gamma_c1(2,1)=dq42L*((M4*dq1L*(MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4) + (M4*dq32L*(MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4) + (M4*dq42L*(MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4)) - dq31L*(dq1L*(L3*cos(q31L + q1L) + L4*cos(q31L + q41L + q1L) - (M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq31L*(L3*cos(q31L + q1L) + L4*cos(q31L + q41L + q1L) - (M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq41L*(L4*cos(q31L + q41L + q1L) - (M4*(MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4))) - dq1L*(dq31L*(L3*cos(q31L + q1L) + L4*cos(q31L + q41L + q1L) - (M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq1L*(L3*cos(q31L + q1L) - (M1*(MZ1*cos(q1L) + MY1*sin(q1L)) + M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4) + L4*cos(q31L + q41L + q1L)) + dq41L*(L4*cos(q31L + q41L + q1L) - (M4*(MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4)) - (dq32L*(M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L))))/(M1 + 2*M3 + 2*M4) - (M4*dq42L*(MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4)) - dq41L*(dq1L*(L4*cos(q31L + q41L + q1L) - (M4*(MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq31L*(L4*cos(q31L + q41L + q1L) - (M4*(MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq41L*(L4*cos(q31L + q41L + q1L) - (M4*(MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4))) + dq32L*((dq1L*(M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L))))/(M1 + 2*M3 + 2*M4) + (dq32L*(M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L))))/(M1 + 2*M3 + 2*M4) + (M4*dq42L*(MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4));
gamma_c2=zeros(2,1);
gamma_c2(1,1)=dq42L*(dq1L*(L4*sin(q32L + q42L + q1L) + (M4*(MY4*cos(q32L + q42L + q1L) - MZ4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq32L*(L4*sin(q32L + q42L + q1L) + (M4*(MY4*cos(q32L + q42L + q1L) - MZ4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq42L*(L4*sin(q32L + q42L + q1L) + (M4*(MY4*cos(q32L + q42L + q1L) - MZ4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4))) - dq31L*((dq1L*(M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) - M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L))))/(M1 + 2*M3 + 2*M4) + (dq31L*(M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) - M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L))))/(M1 + 2*M3 + 2*M4) - (M4*dq41L*(MY4*cos(q31L + q41L + q1L) - MZ4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq1L*(dq1L*(L3*sin(q32L + q1L) + (M1*(MY1*cos(q1L) - MZ1*sin(q1L)) - M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) + M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L)) + M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L)))/(M1 + 2*M3 + 2*M4) + L4*sin(q32L + q42L + q1L)) + dq32L*(L3*sin(q32L + q1L) + L4*sin(q32L + q42L + q1L) - (M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq42L*(L4*sin(q32L + q42L + q1L) + (M4*(MY4*cos(q32L + q42L + q1L) - MZ4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4)) - (dq31L*(M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) - M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L))))/(M1 + 2*M3 + 2*M4) + (M4*dq41L*(MY4*cos(q31L + q41L + q1L) - MZ4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq41L*((M4*dq1L*(MY4*cos(q31L + q41L + q1L) - MZ4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4) + (M4*dq31L*(MY4*cos(q31L + q41L + q1L) - MZ4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4) + (M4*dq41L*(MY4*cos(q31L + q41L + q1L) - MZ4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq32L*(dq1L*(L3*sin(q32L + q1L) + L4*sin(q32L + q42L + q1L) - (M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq32L*(L3*sin(q32L + q1L) + L4*sin(q32L + q42L + q1L) - (M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq42L*(L4*sin(q32L + q42L + q1L) + (M4*(MY4*cos(q32L + q42L + q1L) - MZ4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4)));
gamma_c2(2,1)=dq41L*((M4*dq1L*(MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4) + (M4*dq31L*(MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4) + (M4*dq41L*(MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4)) - dq32L*(dq1L*(L3*cos(q32L + q1L) + L4*cos(q32L + q42L + q1L) - (M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq32L*(L3*cos(q32L + q1L) + L4*cos(q32L + q42L + q1L) - (M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq42L*(L4*cos(q32L + q42L + q1L) - (M4*(MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4))) - dq1L*(dq32L*(L3*cos(q32L + q1L) + L4*cos(q32L + q42L + q1L) - (M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq1L*(L3*cos(q32L + q1L) - (M1*(MZ1*cos(q1L) + MY1*sin(q1L)) + M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4) + L4*cos(q32L + q42L + q1L)) + dq42L*(L4*cos(q32L + q42L + q1L) - (M4*(MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4)) - (dq31L*(M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L))))/(M1 + 2*M3 + 2*M4) - (M4*dq41L*(MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4)) - dq42L*(dq1L*(L4*cos(q32L + q42L + q1L) - (M4*(MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq32L*(L4*cos(q32L + q42L + q1L) - (M4*(MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4)) + dq42L*(L4*cos(q32L + q42L + q1L) - (M4*(MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4))) + dq31L*((dq1L*(M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L))))/(M1 + 2*M3 + 2*M4) + (dq31L*(M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L))))/(M1 + 2*M3 + 2*M4) + (M4*dq41L*(MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4));
pFoot1=zeros(2,1);
pFoot1(1,1)=ycm - L3*sin(q31L + q1L) - (M1*(MY1*cos(q1L) - MZ1*sin(q1L)) - M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) + M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L)) + M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*sin(q31L + q41L + q1L);
pFoot1(2,1)=zcm + L3*cos(q31L + q1L) - (M1*(MZ1*cos(q1L) + MY1*sin(q1L)) + M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4) + L4*cos(q31L + q41L + q1L);
pFoot2=zeros(2,1);
pFoot2(1,1)=ycm - L3*sin(q32L + q1L) - (M1*(MY1*cos(q1L) - MZ1*sin(q1L)) - M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) + M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L)) + M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*sin(q32L + q42L + q1L);
pFoot2(2,1)=zcm + L3*cos(q32L + q1L) - (M1*(MZ1*cos(q1L) + MY1*sin(q1L)) + M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4) + L4*cos(q32L + q42L + q1L);
PE=zeros(1,1);
PE(1,1)=g*zcm*(M1 + 2*M3 + 2*M4);
KE=zeros(1,1);
KE(1,1)=(M1^2*dycm^2 + 4*M3^2*dycm^2 + 4*M4^2*dycm^2 + M1^2*dzcm^2 + 4*M3^2*dzcm^2 + 4*M4^2*dzcm^2 + 2*L3^2*M4^2*dq1L^2 + L3^2*M4^2*dq31L^2 + L3^2*M4^2*dq32L^2 + 2*M3^2*MY3^2*dq1L^2 + 2*M4^2*MY4^2*dq1L^2 + M3^2*MY3^2*dq31L^2 + M3^2*MY3^2*dq32L^2 + M4^2*MY4^2*dq31L^2 + M4^2*MY4^2*dq32L^2 + M4^2*MY4^2*dq41L^2 + M4^2*MY4^2*dq42L^2 + 2*M3^2*MZ3^2*dq1L^2 + 2*M4^2*MZ4^2*dq1L^2 + M3^2*MZ3^2*dq31L^2 + M3^2*MZ3^2*dq32L^2 + M4^2*MZ4^2*dq31L^2 + M4^2*MZ4^2*dq32L^2 + M4^2*MZ4^2*dq41L^2 + M4^2*MZ4^2*dq42L^2 + 4*M1*M3*dycm^2 + 4*M1*M4*dycm^2 + 8*M3*M4*dycm^2 + 4*M1*M3*dzcm^2 + 4*M1*M4*dzcm^2 + 8*M3*M4*dzcm^2 + M1*XX1*dq1L^2 + 2*M1*XX3*dq1L^2 + 2*M3*XX1*dq1L^2 + 2*M1*XX4*dq1L^2 + 2*M4*XX1*dq1L^2 + 4*M3*XX3*dq1L^2 + 4*M3*XX4*dq1L^2 + 4*M4*XX3*dq1L^2 + 4*M4*XX4*dq1L^2 + M1*XX3*dq31L^2 + M1*XX3*dq32L^2 + M1*XX4*dq31L^2 + M1*XX4*dq32L^2 + 2*M3*XX3*dq31L^2 + 2*M3*XX3*dq32L^2 + 2*M3*XX4*dq31L^2 + 2*M4*XX3*dq31L^2 + 2*M3*XX4*dq32L^2 + 2*M4*XX3*dq32L^2 + 2*M4*XX4*dq31L^2 + 2*M4*XX4*dq32L^2 + M1*XX4*dq41L^2 + M1*XX4*dq42L^2 + 2*M3*XX4*dq41L^2 + 2*M3*XX4*dq42L^2 + 2*M4*XX4*dq41L^2 + 2*M4*XX4*dq42L^2 + 2*L3^2*M1*M4*dq1L^2 + 4*L3^2*M3*M4*dq1L^2 + L3^2*M1*M4*dq31L^2 + L3^2*M1*M4*dq32L^2 + 2*L3^2*M3*M4*dq31L^2 + 2*L3^2*M3*M4*dq32L^2 + 2*M1*M3*MY1^2*dq1L^2 + 2*M1*M4*MY1^2*dq1L^2 + 2*M1*M3*MY3^2*dq1L^2 + 2*M1*M4*MY4^2*dq1L^2 + 4*M3*M4*MY3^2*dq1L^2 + 4*M3*M4*MY4^2*dq1L^2 + M1*M3*MY3^2*dq31L^2 + M1*M3*MY3^2*dq32L^2 + M1*M4*MY4^2*dq31L^2 + M1*M4*MY4^2*dq32L^2 + 2*M3*M4*MY3^2*dq31L^2 + 2*M3*M4*MY3^2*dq32L^2 + 2*M3*M4*MY4^2*dq31L^2 + 2*M3*M4*MY4^2*dq32L^2 + M1*M4*MY4^2*dq41L^2 + M1*M4*MY4^2*dq42L^2 + 2*M3*M4*MY4^2*dq41L^2 + 2*M3*M4*MY4^2*dq42L^2 + 2*M1*M3*MZ1^2*dq1L^2 + 2*M1*M4*MZ1^2*dq1L^2 + 2*M1*M3*MZ3^2*dq1L^2 + 2*M1*M4*MZ4^2*dq1L^2 + 4*M3*M4*MZ3^2*dq1L^2 + 4*M3*M4*MZ4^2*dq1L^2 + M1*M3*MZ3^2*dq31L^2 + M1*M3*MZ3^2*dq32L^2 + M1*M4*MZ4^2*dq31L^2 + M1*M4*MZ4^2*dq32L^2 + 2*M3*M4*MZ3^2*dq31L^2 + 2*M3*M4*MZ3^2*dq32L^2 + 2*M3*M4*MZ4^2*dq31L^2 + 2*M3*M4*MZ4^2*dq32L^2 + M1*M4*MZ4^2*dq41L^2 + M1*M4*MZ4^2*dq42L^2 + 2*M3*M4*MZ4^2*dq41L^2 + 2*M3*M4*MZ4^2*dq42L^2 - 2*L3^2*M4^2*dq1L^2*cos(q31L - q32L) + 2*L3^2*M4^2*dq1L*dq31L + 2*L3^2*M4^2*dq1L*dq32L - 2*M3^2*MY3^2*dq1L^2*cos(q31L - q32L) - 2*M3^2*MZ3^2*dq1L^2*cos(q31L - q32L) + 2*M3^2*MY3^2*dq1L*dq31L + 2*M3^2*MY3^2*dq1L*dq32L + 2*M4^2*MY4^2*dq1L*dq31L + 2*M4^2*MY4^2*dq1L*dq32L + 2*M4^2*MY4^2*dq1L*dq41L + 2*M4^2*MY4^2*dq1L*dq42L + 2*M4^2*MY4^2*dq31L*dq41L + 2*M4^2*MY4^2*dq32L*dq42L + 2*M3^2*MZ3^2*dq1L*dq31L + 2*M3^2*MZ3^2*dq1L*dq32L + 2*M4^2*MZ4^2*dq1L*dq31L + 2*M4^2*MZ4^2*dq1L*dq32L + 2*M4^2*MZ4^2*dq1L*dq41L + 2*M4^2*MZ4^2*dq1L*dq42L + 2*M4^2*MZ4^2*dq31L*dq41L + 2*M4^2*MZ4^2*dq32L*dq42L - 2*M4^2*MY4^2*dq1L^2*cos(q31L - q32L + q41L - q42L) - 2*M4^2*MZ4^2*dq1L^2*cos(q31L - q32L + q41L - q42L) + 2*M1*XX3*dq1L*dq31L + 2*M1*XX3*dq1L*dq32L + 2*M1*XX4*dq1L*dq31L + 2*M1*XX4*dq1L*dq32L + 4*M3*XX3*dq1L*dq31L + 4*M3*XX3*dq1L*dq32L + 4*M3*XX4*dq1L*dq31L + 4*M4*XX3*dq1L*dq31L + 4*M3*XX4*dq1L*dq32L + 4*M4*XX3*dq1L*dq32L + 4*M4*XX4*dq1L*dq31L + 4*M4*XX4*dq1L*dq32L + 2*M1*XX4*dq1L*dq41L + 2*M1*XX4*dq1L*dq42L + 4*M3*XX4*dq1L*dq41L + 4*M3*XX4*dq1L*dq42L + 4*M4*XX4*dq1L*dq41L + 4*M4*XX4*dq1L*dq42L + 2*M1*XX4*dq31L*dq41L + 2*M1*XX4*dq32L*dq42L + 4*M3*XX4*dq31L*dq41L + 4*M4*XX4*dq31L*dq41L + 4*M3*XX4*dq32L*dq42L + 4*M4*XX4*dq32L*dq42L + 2*L3*M4^2*MZ4*dq1L^2*cos(q41L) + 2*L3*M4^2*MZ4*dq1L^2*cos(q42L) + 2*L3*M4^2*MZ4*dq31L^2*cos(q41L) + 2*L3*M4^2*MZ4*dq32L^2*cos(q42L) - 2*L3*M4^2*MZ4*dq1L^2*cos(q31L - q32L - q42L) + 2*L3*M4^2*MY4*dq1L^2*sin(q41L) + 2*L3*M4^2*MY4*dq1L^2*sin(q42L) + 2*L3*M4^2*MY4*dq31L^2*sin(q41L) + 2*L3*M4^2*MY4*dq32L^2*sin(q42L) + 2*L3*M4^2*MY4*dq1L^2*sin(q31L - q32L - q42L) - 4*L3*M3*M4*MZ3*dq1L^2 - 2*L3*M3*M4*MZ3*dq31L^2 - 2*L3*M3*M4*MZ3*dq32L^2 + 2*L3^2*M1*M4*dq1L*dq31L + 2*L3^2*M1*M4*dq1L*dq32L + 4*L3^2*M3*M4*dq1L*dq31L + 4*L3^2*M3*M4*dq1L*dq32L + 2*M1*M3*MY3^2*dq1L*dq31L + 2*M1*M3*MY3^2*dq1L*dq32L + 2*M1*M4*MY4^2*dq1L*dq31L + 2*M1*M4*MY4^2*dq1L*dq32L + 4*M3*M4*MY3^2*dq1L*dq31L + 4*M3*M4*MY3^2*dq1L*dq32L + 4*M3*M4*MY4^2*dq1L*dq31L + 4*M3*M4*MY4^2*dq1L*dq32L + 2*M1*M4*MY4^2*dq1L*dq41L + 2*M1*M4*MY4^2*dq1L*dq42L + 4*M3*M4*MY4^2*dq1L*dq41L + 4*M3*M4*MY4^2*dq1L*dq42L + 2*M1*M4*MY4^2*dq31L*dq41L + 2*M1*M4*MY4^2*dq32L*dq42L + 4*M3*M4*MY4^2*dq31L*dq41L + 4*M3*M4*MY4^2*dq32L*dq42L + 2*M1*M3*MZ3^2*dq1L*dq31L + 2*M1*M3*MZ3^2*dq1L*dq32L + 2*M1*M4*MZ4^2*dq1L*dq31L + 2*M1*M4*MZ4^2*dq1L*dq32L + 4*M3*M4*MZ3^2*dq1L*dq31L + 4*M3*M4*MZ3^2*dq1L*dq32L + 4*M3*M4*MZ4^2*dq1L*dq31L + 4*M3*M4*MZ4^2*dq1L*dq32L + 2*M1*M4*MZ4^2*dq1L*dq41L + 2*M1*M4*MZ4^2*dq1L*dq42L + 4*M3*M4*MZ4^2*dq1L*dq41L + 4*M3*M4*MZ4^2*dq1L*dq42L + 2*M1*M4*MZ4^2*dq31L*dq41L + 2*M1*M4*MZ4^2*dq32L*dq42L + 4*M3*M4*MZ4^2*dq31L*dq41L + 4*M3*M4*MZ4^2*dq32L*dq42L - 2*L3^2*M4^2*dq1L*dq31L*cos(q31L - q32L) - 2*L3^2*M4^2*dq1L*dq32L*cos(q31L - q32L) - 2*L3^2*M4^2*dq31L*dq32L*cos(q31L - q32L) - 2*M3^2*MY3^2*dq1L*dq31L*cos(q31L - q32L) - 2*M3^2*MY3^2*dq1L*dq32L*cos(q31L - q32L) - 2*M3^2*MY3^2*dq31L*dq32L*cos(q31L - q32L) - 2*M3^2*MZ3^2*dq1L*dq31L*cos(q31L - q32L) - 2*M3^2*MZ3^2*dq1L*dq32L*cos(q31L - q32L) - 2*M3^2*MZ3^2*dq31L*dq32L*cos(q31L - q32L) - 2*M4^2*MY4^2*dq1L*dq31L*cos(q31L - q32L + q41L - q42L) - 2*M4^2*MY4^2*dq1L*dq32L*cos(q31L - q32L + q41L - q42L) - 2*M4^2*MY4^2*dq1L*dq41L*cos(q31L - q32L + q41L - q42L) - 2*M4^2*MY4^2*dq1L*dq42L*cos(q31L - q32L + q41L - q42L) - 2*M4^2*MY4^2*dq31L*dq32L*cos(q31L - q32L + q41L - q42L) - 2*M4^2*MY4^2*dq31L*dq42L*cos(q31L - q32L + q41L - q42L) - 2*M4^2*MY4^2*dq32L*dq41L*cos(q31L - q32L + q41L - q42L) - 2*M4^2*MY4^2*dq41L*dq42L*cos(q31L - q32L + q41L - q42L) - 2*M4^2*MZ4^2*dq1L*dq31L*cos(q31L - q32L + q41L - q42L) - 2*M4^2*MZ4^2*dq1L*dq32L*cos(q31L - q32L + q41L - q42L) - 2*M4^2*MZ4^2*dq1L*dq41L*cos(q31L - q32L + q41L - q42L) - 2*M4^2*MZ4^2*dq1L*dq42L*cos(q31L - q32L + q41L - q42L) - 2*M4^2*MZ4^2*dq31L*dq32L*cos(q31L - q32L + q41L - q42L) - 2*M4^2*MZ4^2*dq31L*dq42L*cos(q31L - q32L + q41L - q42L) - 2*M4^2*MZ4^2*dq32L*dq41L*cos(q31L - q32L + q41L - q42L) - 2*M4^2*MZ4^2*dq41L*dq42L*cos(q31L - q32L + q41L - q42L) - 2*L3*M4^2*MZ4*dq1L^2*cos(q31L - q32L + q41L) - 2*L3*M4^2*MY4*dq1L^2*sin(q31L - q32L + q41L) + 2*M1*M4*MY1*MZ4*dq1L^2*sin(q31L + q41L) - 2*M1*M4*MY4*MZ1*dq1L^2*sin(q31L + q41L) + 2*M1*M4*MY1*MZ4*dq1L^2*sin(q32L + q42L) - 2*M1*M4*MY4*MZ1*dq1L^2*sin(q32L + q42L) - 2*L3*M1*M4*MZ1*dq1L^2*cos(q31L) - 2*L3*M1*M4*MZ1*dq1L^2*cos(q32L) + 2*L3*M1*M4*MZ4*dq1L^2*cos(q41L) + 2*L3*M1*M4*MZ4*dq1L^2*cos(q42L) + 4*L3*M3*M4*MZ4*dq1L^2*cos(q41L) + 4*L3*M3*M4*MZ4*dq1L^2*cos(q42L) + 2*L3*M1*M4*MZ4*dq31L^2*cos(q41L) + 2*L3*M1*M4*MZ4*dq32L^2*cos(q42L) + 4*L3*M3*M4*MZ4*dq31L^2*cos(q41L) + 4*L3*M3*M4*MZ4*dq32L^2*cos(q42L) - 2*M1*M3*MY1*MY3*dq1L^2*cos(q31L) - 2*M1*M3*MY1*MY3*dq1L^2*cos(q32L) - 2*M3*M4*MY3*MY4*dq1L^2*cos(q41L) - 2*M3*M4*MY3*MY4*dq1L^2*cos(q42L) - 2*M3*M4*MY3*MY4*dq31L^2*cos(q41L) - 2*M3*M4*MY3*MY4*dq32L^2*cos(q42L) - 2*M1*M3*MZ1*MZ3*dq1L^2*cos(q31L) - 2*M1*M3*MZ1*MZ3*dq1L^2*cos(q32L) - 2*M3*M4*MZ3*MZ4*dq1L^2*cos(q41L) - 2*M3*M4*MZ3*MZ4*dq1L^2*cos(q42L) - 2*M3*M4*MZ3*MZ4*dq31L^2*cos(q41L) - 2*M3*M4*MZ3*MZ4*dq32L^2*cos(q42L) - 2*M3*M4*MY3*MY4*dq1L^2*cos(q31L - q32L - q42L) - 2*M3*M4*MZ3*MZ4*dq1L^2*cos(q31L - q32L - q42L) + 2*L3*M1*M4*MY1*dq1L^2*sin(q31L) + 2*L3*M1*M4*MY1*dq1L^2*sin(q32L) + 2*L3*M1*M4*MY4*dq1L^2*sin(q41L) + 2*L3*M1*M4*MY4*dq1L^2*sin(q42L) + 4*L3*M3*M4*MY4*dq1L^2*sin(q41L) + 4*L3*M3*M4*MY4*dq1L^2*sin(q42L) + 2*L3*M1*M4*MY4*dq31L^2*sin(q41L) + 2*L3*M1*M4*MY4*dq32L^2*sin(q42L) + 4*L3*M3*M4*MY4*dq31L^2*sin(q41L) + 4*L3*M3*M4*MY4*dq32L^2*sin(q42L) + 2*M1*M3*MY1*MZ3*dq1L^2*sin(q31L) - 2*M1*M3*MY3*MZ1*dq1L^2*sin(q31L) + 2*M1*M3*MY1*MZ3*dq1L^2*sin(q32L) - 2*M1*M3*MY3*MZ1*dq1L^2*sin(q32L) + 2*M3*M4*MY3*MZ4*dq1L^2*sin(q41L) - 2*M3*M4*MY4*MZ3*dq1L^2*sin(q41L) + 2*M3*M4*MY3*MZ4*dq1L^2*sin(q42L) - 2*M3*M4*MY4*MZ3*dq1L^2*sin(q42L) + 2*M3*M4*MY3*MZ4*dq31L^2*sin(q41L) - 2*M3*M4*MY4*MZ3*dq31L^2*sin(q41L) + 2*M3*M4*MY3*MZ4*dq32L^2*sin(q42L) - 2*M3*M4*MY4*MZ3*dq32L^2*sin(q42L) - 2*M3*M4*MY3*MZ4*dq1L^2*sin(q31L - q32L - q42L) + 2*M3*M4*MY4*MZ3*dq1L^2*sin(q31L - q32L - q42L) + 4*L3*M4^2*MZ4*dq1L*dq31L*cos(q41L) + 4*L3*M4^2*MZ4*dq1L*dq32L*cos(q42L) + 2*L3*M4^2*MZ4*dq1L*dq41L*cos(q41L) + 2*L3*M4^2*MZ4*dq1L*dq42L*cos(q42L) + 2*L3*M4^2*MZ4*dq31L*dq41L*cos(q41L) + 2*L3*M4^2*MZ4*dq32L*dq42L*cos(q42L) - 2*L3*M4^2*MZ4*dq1L*dq31L*cos(q31L - q32L - q42L) - 2*L3*M4^2*MZ4*dq1L*dq32L*cos(q31L - q32L - q42L) - 2*L3*M4^2*MZ4*dq1L*dq42L*cos(q31L - q32L - q42L) - 2*L3*M4^2*MZ4*dq31L*dq32L*cos(q31L - q32L - q42L) - 2*L3*M4^2*MZ4*dq31L*dq42L*cos(q31L - q32L - q42L) + 4*L3*M4^2*MY4*dq1L*dq31L*sin(q41L) + 4*L3*M4^2*MY4*dq1L*dq32L*sin(q42L) + 2*L3*M4^2*MY4*dq1L*dq41L*sin(q41L) + 2*L3*M4^2*MY4*dq1L*dq42L*sin(q42L) + 2*L3*M4^2*MY4*dq31L*dq41L*sin(q41L) + 2*L3*M4^2*MY4*dq32L*dq42L*sin(q42L) + 2*L3*M4^2*MY4*dq1L*dq31L*sin(q31L - q32L - q42L) + 2*L3*M4^2*MY4*dq1L*dq32L*sin(q31L - q32L - q42L) + 2*L3*M4^2*MY4*dq1L*dq42L*sin(q31L - q32L - q42L) + 2*L3*M4^2*MY4*dq31L*dq32L*sin(q31L - q32L - q42L) + 2*L3*M4^2*MY4*dq31L*dq42L*sin(q31L - q32L - q42L) - 4*L3*M3*M4*MZ3*dq1L^2*cos(q31L - q32L) - 4*L3*M3*M4*MZ3*dq1L*dq31L - 4*L3*M3*M4*MZ3*dq1L*dq32L - 2*M3*M4*MY3*MY4*dq1L^2*cos(q31L - q32L + q41L) - 2*M3*M4*MZ3*MZ4*dq1L^2*cos(q31L - q32L + q41L) + 2*M3*M4*MY3*MZ4*dq1L^2*sin(q31L - q32L + q41L) - 2*M3*M4*MY4*MZ3*dq1L^2*sin(q31L - q32L + q41L) - 2*L3*M4^2*MZ4*dq1L*dq31L*cos(q31L - q32L + q41L) - 2*L3*M4^2*MZ4*dq1L*dq32L*cos(q31L - q32L + q41L) - 2*L3*M4^2*MZ4*dq1L*dq41L*cos(q31L - q32L + q41L) - 2*L3*M4^2*MZ4*dq31L*dq32L*cos(q31L - q32L + q41L) - 2*L3*M4^2*MZ4*dq32L*dq41L*cos(q31L - q32L + q41L) - 2*L3*M4^2*MY4*dq1L*dq31L*sin(q31L - q32L + q41L) - 2*L3*M4^2*MY4*dq1L*dq32L*sin(q31L - q32L + q41L) - 2*L3*M4^2*MY4*dq1L*dq41L*sin(q31L - q32L + q41L) - 2*L3*M4^2*MY4*dq31L*dq32L*sin(q31L - q32L + q41L) - 2*L3*M4^2*MY4*dq32L*dq41L*sin(q31L - q32L + q41L) - 2*M1*M4*MY1*MY4*dq1L^2*cos(q31L + q41L) - 2*M1*M4*MY1*MY4*dq1L^2*cos(q32L + q42L) - 2*M1*M4*MZ1*MZ4*dq1L^2*cos(q31L + q41L) - 2*M1*M4*MZ1*MZ4*dq1L^2*cos(q32L + q42L) - 2*M1*M4*MY1*MY4*dq1L*dq31L*cos(q31L + q41L) - 2*M1*M4*MY1*MY4*dq1L*dq32L*cos(q32L + q42L) - 2*M1*M4*MY1*MY4*dq1L*dq41L*cos(q31L + q41L) - 2*M1*M4*MY1*MY4*dq1L*dq42L*cos(q32L + q42L) - 2*M1*M4*MZ1*MZ4*dq1L*dq31L*cos(q31L + q41L) - 2*M1*M4*MZ1*MZ4*dq1L*dq32L*cos(q32L + q42L) - 2*M1*M4*MZ1*MZ4*dq1L*dq41L*cos(q31L + q41L) - 2*M1*M4*MZ1*MZ4*dq1L*dq42L*cos(q32L + q42L) + 2*M1*M4*MY1*MZ4*dq1L*dq31L*sin(q31L + q41L) - 2*M1*M4*MY4*MZ1*dq1L*dq31L*sin(q31L + q41L) + 2*M1*M4*MY1*MZ4*dq1L*dq32L*sin(q32L + q42L) - 2*M1*M4*MY4*MZ1*dq1L*dq32L*sin(q32L + q42L) + 2*M1*M4*MY1*MZ4*dq1L*dq41L*sin(q31L + q41L) - 2*M1*M4*MY4*MZ1*dq1L*dq41L*sin(q31L + q41L) + 2*M1*M4*MY1*MZ4*dq1L*dq42L*sin(q32L + q42L) - 2*M1*M4*MY4*MZ1*dq1L*dq42L*sin(q32L + q42L) - 2*L3*M1*M4*MZ1*dq1L*dq31L*cos(q31L) - 2*L3*M1*M4*MZ1*dq1L*dq32L*cos(q32L) + 4*L3*M1*M4*MZ4*dq1L*dq31L*cos(q41L) + 4*L3*M1*M4*MZ4*dq1L*dq32L*cos(q42L) + 8*L3*M3*M4*MZ4*dq1L*dq31L*cos(q41L) + 8*L3*M3*M4*MZ4*dq1L*dq32L*cos(q42L) + 2*L3*M1*M4*MZ4*dq1L*dq41L*cos(q41L) + 2*L3*M1*M4*MZ4*dq1L*dq42L*cos(q42L) + 4*L3*M3*M4*MZ4*dq1L*dq41L*cos(q41L) + 4*L3*M3*M4*MZ4*dq1L*dq42L*cos(q42L) + 2*L3*M1*M4*MZ4*dq31L*dq41L*cos(q41L) + 4*L3*M3*M4*MZ4*dq31L*dq41L*cos(q41L) + 2*L3*M1*M4*MZ4*dq32L*dq42L*cos(q42L) + 4*L3*M3*M4*MZ4*dq32L*dq42L*cos(q42L) - 2*M1*M3*MY1*MY3*dq1L*dq31L*cos(q31L) - 2*M1*M3*MY1*MY3*dq1L*dq32L*cos(q32L) - 4*M3*M4*MY3*MY4*dq1L*dq31L*cos(q41L) - 4*M3*M4*MY3*MY4*dq1L*dq32L*cos(q42L) - 2*M3*M4*MY3*MY4*dq1L*dq41L*cos(q41L) - 2*M3*M4*MY3*MY4*dq1L*dq42L*cos(q42L) - 2*M3*M4*MY3*MY4*dq31L*dq41L*cos(q41L) - 2*M3*M4*MY3*MY4*dq32L*dq42L*cos(q42L) - 2*M1*M3*MZ1*MZ3*dq1L*dq31L*cos(q31L) - 2*M1*M3*MZ1*MZ3*dq1L*dq32L*cos(q32L) - 4*M3*M4*MZ3*MZ4*dq1L*dq31L*cos(q41L) - 4*M3*M4*MZ3*MZ4*dq1L*dq32L*cos(q42L) - 2*M3*M4*MZ3*MZ4*dq1L*dq41L*cos(q41L) - 2*M3*M4*MZ3*MZ4*dq1L*dq42L*cos(q42L) - 2*M3*M4*MZ3*MZ4*dq31L*dq41L*cos(q41L) - 2*M3*M4*MZ3*MZ4*dq32L*dq42L*cos(q42L) - 2*M3*M4*MY3*MY4*dq1L*dq31L*cos(q31L - q32L - q42L) - 2*M3*M4*MY3*MY4*dq1L*dq32L*cos(q31L - q32L - q42L) - 2*M3*M4*MY3*MY4*dq1L*dq42L*cos(q31L - q32L - q42L) - 2*M3*M4*MY3*MY4*dq31L*dq32L*cos(q31L - q32L - q42L) - 2*M3*M4*MY3*MY4*dq31L*dq42L*cos(q31L - q32L - q42L) - 2*M3*M4*MZ3*MZ4*dq1L*dq31L*cos(q31L - q32L - q42L) - 2*M3*M4*MZ3*MZ4*dq1L*dq32L*cos(q31L - q32L - q42L) - 2*M3*M4*MZ3*MZ4*dq1L*dq42L*cos(q31L - q32L - q42L) - 2*M3*M4*MZ3*MZ4*dq31L*dq32L*cos(q31L - q32L - q42L) - 2*M3*M4*MZ3*MZ4*dq31L*dq42L*cos(q31L - q32L - q42L) + 2*L3*M1*M4*MY1*dq1L*dq31L*sin(q31L) + 2*L3*M1*M4*MY1*dq1L*dq32L*sin(q32L) + 4*L3*M1*M4*MY4*dq1L*dq31L*sin(q41L) + 4*L3*M1*M4*MY4*dq1L*dq32L*sin(q42L) + 8*L3*M3*M4*MY4*dq1L*dq31L*sin(q41L) + 8*L3*M3*M4*MY4*dq1L*dq32L*sin(q42L) + 2*L3*M1*M4*MY4*dq1L*dq41L*sin(q41L) + 2*L3*M1*M4*MY4*dq1L*dq42L*sin(q42L) + 4*L3*M3*M4*MY4*dq1L*dq41L*sin(q41L) + 4*L3*M3*M4*MY4*dq1L*dq42L*sin(q42L) + 2*L3*M1*M4*MY4*dq31L*dq41L*sin(q41L) + 4*L3*M3*M4*MY4*dq31L*dq41L*sin(q41L) + 2*L3*M1*M4*MY4*dq32L*dq42L*sin(q42L) + 4*L3*M3*M4*MY4*dq32L*dq42L*sin(q42L) + 2*M1*M3*MY1*MZ3*dq1L*dq31L*sin(q31L) - 2*M1*M3*MY3*MZ1*dq1L*dq31L*sin(q31L) + 2*M1*M3*MY1*MZ3*dq1L*dq32L*sin(q32L) - 2*M1*M3*MY3*MZ1*dq1L*dq32L*sin(q32L) + 4*M3*M4*MY3*MZ4*dq1L*dq31L*sin(q41L) - 4*M3*M4*MY4*MZ3*dq1L*dq31L*sin(q41L) + 4*M3*M4*MY3*MZ4*dq1L*dq32L*sin(q42L) - 4*M3*M4*MY4*MZ3*dq1L*dq32L*sin(q42L) + 2*M3*M4*MY3*MZ4*dq1L*dq41L*sin(q41L) - 2*M3*M4*MY4*MZ3*dq1L*dq41L*sin(q41L) + 2*M3*M4*MY3*MZ4*dq1L*dq42L*sin(q42L) - 2*M3*M4*MY4*MZ3*dq1L*dq42L*sin(q42L) + 2*M3*M4*MY3*MZ4*dq31L*dq41L*sin(q41L) - 2*M3*M4*MY4*MZ3*dq31L*dq41L*sin(q41L) + 2*M3*M4*MY3*MZ4*dq32L*dq42L*sin(q42L) - 2*M3*M4*MY4*MZ3*dq32L*dq42L*sin(q42L) - 2*M3*M4*MY3*MZ4*dq1L*dq31L*sin(q31L - q32L - q42L) + 2*M3*M4*MY4*MZ3*dq1L*dq31L*sin(q31L - q32L - q42L) - 2*M3*M4*MY3*MZ4*dq1L*dq32L*sin(q31L - q32L - q42L) + 2*M3*M4*MY4*MZ3*dq1L*dq32L*sin(q31L - q32L - q42L) - 2*M3*M4*MY3*MZ4*dq1L*dq42L*sin(q31L - q32L - q42L) + 2*M3*M4*MY4*MZ3*dq1L*dq42L*sin(q31L - q32L - q42L) - 2*M3*M4*MY3*MZ4*dq31L*dq32L*sin(q31L - q32L - q42L) + 2*M3*M4*MY4*MZ3*dq31L*dq32L*sin(q31L - q32L - q42L) - 2*M3*M4*MY3*MZ4*dq31L*dq42L*sin(q31L - q32L - q42L) + 2*M3*M4*MY4*MZ3*dq31L*dq42L*sin(q31L - q32L - q42L) - 4*L3*M3*M4*MZ3*dq1L*dq31L*cos(q31L - q32L) - 4*L3*M3*M4*MZ3*dq1L*dq32L*cos(q31L - q32L) - 4*L3*M3*M4*MZ3*dq31L*dq32L*cos(q31L - q32L) - 2*M3*M4*MY3*MY4*dq1L*dq31L*cos(q31L - q32L + q41L) - 2*M3*M4*MY3*MY4*dq1L*dq32L*cos(q31L - q32L + q41L) - 2*M3*M4*MY3*MY4*dq1L*dq41L*cos(q31L - q32L + q41L) - 2*M3*M4*MY3*MY4*dq31L*dq32L*cos(q31L - q32L + q41L) - 2*M3*M4*MY3*MY4*dq32L*dq41L*cos(q31L - q32L + q41L) - 2*M3*M4*MZ3*MZ4*dq1L*dq31L*cos(q31L - q32L + q41L) - 2*M3*M4*MZ3*MZ4*dq1L*dq32L*cos(q31L - q32L + q41L) - 2*M3*M4*MZ3*MZ4*dq1L*dq41L*cos(q31L - q32L + q41L) - 2*M3*M4*MZ3*MZ4*dq31L*dq32L*cos(q31L - q32L + q41L) - 2*M3*M4*MZ3*MZ4*dq32L*dq41L*cos(q31L - q32L + q41L) + 2*M3*M4*MY3*MZ4*dq1L*dq31L*sin(q31L - q32L + q41L) - 2*M3*M4*MY4*MZ3*dq1L*dq31L*sin(q31L - q32L + q41L) + 2*M3*M4*MY3*MZ4*dq1L*dq32L*sin(q31L - q32L + q41L) - 2*M3*M4*MY4*MZ3*dq1L*dq32L*sin(q31L - q32L + q41L) + 2*M3*M4*MY3*MZ4*dq1L*dq41L*sin(q31L - q32L + q41L) - 2*M3*M4*MY4*MZ3*dq1L*dq41L*sin(q31L - q32L + q41L) + 2*M3*M4*MY3*MZ4*dq31L*dq32L*sin(q31L - q32L + q41L) - 2*M3*M4*MY4*MZ3*dq31L*dq32L*sin(q31L - q32L + q41L) + 2*M3*M4*MY3*MZ4*dq32L*dq41L*sin(q31L - q32L + q41L) - 2*M3*M4*MY4*MZ3*dq32L*dq41L*sin(q31L - q32L + q41L))/(2*M1 + 4*M3 + 4*M4);