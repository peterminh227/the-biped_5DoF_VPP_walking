function [PE] = potential_energy_5DoF(x)
% POTENTIAL_ENERGY_5DOF
%   [PE] = POTENTIAL_ENERGY_5DOF(X)  

%Eric Westervelt
%2016 Version: Peter Minh
%05-Dec-2016 17:03:23

modelP;

[nn,mm] = size(x);

if nn ~= 1 & mm ~= 1
  PE = g.*(M4.*MZ4.*cos(x(:,1) + x(:,3) + x(:,5)) - 2.*L4.*M3.* ...
       cos(x(:,1) + x(:,3) + x(:,5)) - 2.*L4.*M4.*cos(x(:,1) + x(:,3) + ...
        x(:,5)) - L4.*M1.*cos(x(:,1) + x(:,3) + x(:,5)) + M4.*MZ4.* ...
       cos(x(:,2) + x(:,4) + x(:,5)) + M4.*MY4.*sin(x(:,1) + x(:,3) + ...
        x(:,5)) + M4.*MY4.*sin(x(:,2) + x(:,4) + x(:,5)) - L3.*M1.* ...
       cos(x(:,1) + x(:,5)) - 2.*L3.*M3.*cos(x(:,1) + x(:,5)) - L3.*M4.* ...
       cos(x(:,1) + x(:,5)) + L3.*M4.*cos(x(:,2) + x(:,5)) + M3.*MZ3.* ...
       cos(x(:,1) + x(:,5)) + M3.*MZ3.*cos(x(:,2) + x(:,5)) + M3.*MY3.* ...
       sin(x(:,1) + x(:,5)) + M3.*MY3.*sin(x(:,2) + x(:,5)) + M1.*MZ1.* ...
       cos(x(:,5)) + M1.*MY1.*sin(x(:,5)));
else
  PE = g*(M4*MZ4*cos(x(1) + x(3) + x(5)) - 2*L4*M3*cos(x(1) + x(3) + ...
        x(5)) - 2*L4*M4*cos(x(1) + x(3) + x(5)) - L4*M1*cos(x(1) + ...
        x(3) + x(5)) + M4*MZ4*cos(x(2) + x(4) + x(5)) + M4*MY4* ...
       sin(x(1) + x(3) + x(5)) + M4*MY4*sin(x(2) + x(4) + x(5)) - L3*M1* ...
       cos(x(1) + x(5)) - 2*L3*M3*cos(x(1) + x(5)) - L3*M4*cos(x(1) + ...
        x(5)) + L3*M4*cos(x(2) + x(5)) + M3*MZ3*cos(x(1) + x(5)) + M3* ...
       MZ3*cos(x(2) + x(5)) + M3*MY3*sin(x(1) + x(5)) + M3*MY3* ...
       sin(x(2) + x(5)) + M1*MZ1*cos(x(5)) + M1*MY1*sin(x(5)));
end
