function [D,C,G,B,E1] = dyn_mod_5links_7DoF(q,dq)
% DYN_MOD_5LINKS_7DOF
%   [D,C,G,B,E1] = DYN_MOD_5LINKS_7DOF(Q,DQ)  is the kneed biped walking model.

%Eric Westervelt
%2016 Version: Peter Minh
%02-Dec-2016 03:17:57

modelP;


q31L=q(1);q32L=q(2);q41L=q(3);q42L=q(4);q1L=q(5);ycm=q(6);zcm=q(7);
dq31L=dq(1);dq32L=dq(2);dq41L=dq(3);dq42L=dq(4);dq1L=dq(5);dycm=dq(6);dzcm=dq(7);% D matrix
D=zeros(7);
D(1,1)=(M1*XX3 + M1*XX4 + 2*M3*XX3 + 2*M3*XX4 + 2*M4*XX3 + 2*M4*XX4 + ...
        L3^2*M4^2 + M3^2*MY3^2 + M4^2*MY4^2 + M3^2*MZ3^2 + M4^2*MZ4^2 + ...
        L3^2*M1*M4 + 2*L3^2*M3*M4 + M1*M3*MY3^2 + M1*M4*MY4^2 + 2*M3*M4* ...
       MY3^2 + 2*M3*M4*MY4^2 + M1*M3*MZ3^2 + M1*M4*MZ4^2 + 2*M3*M4* ...
       MZ3^2 + 2*M3*M4*MZ4^2 + 2*L3*M4^2*MZ4*cos(q41L) + 2*L3*M4^2*MY4* ...
       sin(q41L) - 2*L3*M3*M4*MZ3 + 2*L3*M1*M4*MZ4*cos(q41L) + 4*L3*M3* ...
       M4*MZ4*cos(q41L) - 2*M3*M4*MY3*MY4*cos(q41L) - 2*M3*M4*MZ3*MZ4* ...
       cos(q41L) + 2*L3*M1*M4*MY4*sin(q41L) + 4*L3*M3*M4*MY4*sin(q41L) + ...
        2*M3*M4*MY3*MZ4*sin(q41L) - 2*M3*M4*MY4*MZ3*sin(q41L))/(M1 + 2* ...
       M3 + 2*M4);
D(1,2)=-(L3^2*M4^2*cos(q31L - q32L) + M3^2*MY3^2*cos(q31L - q32L) + ...
        M3^2*MZ3^2*cos(q31L - q32L) + M4^2*MY4^2*cos(q31L - q32L + ...
        q41L - q42L) + M4^2*MZ4^2*cos(q31L - q32L + q41L - q42L) + L3* ...
       M4^2*MZ4*cos(q31L - q32L + q41L) + L3*M4^2*MY4*sin(q31L - q32L + ...
        q41L) + L3*M4^2*MZ4*cos(q31L - q32L - q42L) - L3*M4^2*MY4* ...
       sin(q31L - q32L - q42L) + M3*M4*MY3*MY4*cos(q31L - q32L + q41L) + ...
        M3*M4*MZ3*MZ4*cos(q31L - q32L + q41L) - M3*M4*MY3*MZ4*sin(q31L - ...
        q32L + q41L) + M3*M4*MY4*MZ3*sin(q31L - q32L + q41L) + M3*M4* ...
       MY3*MY4*cos(q31L - q32L - q42L) + M3*M4*MZ3*MZ4*cos(q31L - q32L - ...
        q42L) + M3*M4*MY3*MZ4*sin(q31L - q32L - q42L) - M3*M4*MY4*MZ3* ...
       sin(q31L - q32L - q42L) + 2*L3*M3*M4*MZ3*cos(q31L - q32L))/(M1 + ...
        2*M3 + 2*M4);
D(1,3)=(M1*XX4 + 2*M3*XX4 + 2*M4*XX4 + M4^2*MY4^2 + M4^2*MZ4^2 + M1*M4* ...
       MY4^2 + 2*M3*M4*MY4^2 + M1*M4*MZ4^2 + 2*M3*M4*MZ4^2 + L3*M4^2* ...
       MZ4*cos(q41L) + L3*M4^2*MY4*sin(q41L) + L3*M1*M4*MZ4*cos(q41L) + ...
        2*L3*M3*M4*MZ4*cos(q41L) - M3*M4*MY3*MY4*cos(q41L) - M3*M4*MZ3* ...
       MZ4*cos(q41L) + L3*M1*M4*MY4*sin(q41L) + 2*L3*M3*M4*MY4* ...
       sin(q41L) + M3*M4*MY3*MZ4*sin(q41L) - M3*M4*MY4*MZ3* ...
       sin(q41L))/(M1 + 2*M3 + 2*M4);
D(1,4)=-(M4^2*MY4^2*cos(q31L - q32L + q41L - q42L) + M4^2*MZ4^2* ...
       cos(q31L - q32L + q41L - q42L) + L3*M4^2*MZ4*cos(q31L - q32L - ...
        q42L) - L3*M4^2*MY4*sin(q31L - q32L - q42L) + M3*M4*MY3*MY4* ...
       cos(q31L - q32L - q42L) + M3*M4*MZ3*MZ4*cos(q31L - q32L - q42L) + ...
        M3*M4*MY3*MZ4*sin(q31L - q32L - q42L) - M3*M4*MY4*MZ3*sin(q31L - ...
        q32L - q42L))/(M1 + 2*M3 + 2*M4);
D(1,5)=(M1*XX3 + M1*XX4 + 2*M3*XX3 + 2*M3*XX4 + 2*M4*XX3 + 2*M4*XX4 + ...
        L3^2*M4^2 + M3^2*MY3^2 + M4^2*MY4^2 + M3^2*MZ3^2 + M4^2*MZ4^2 + ...
        L3^2*M1*M4 + 2*L3^2*M3*M4 + M1*M3*MY3^2 + M1*M4*MY4^2 + 2*M3*M4* ...
       MY3^2 + 2*M3*M4*MY4^2 + M1*M3*MZ3^2 + M1*M4*MZ4^2 + 2*M3*M4* ...
       MZ3^2 + 2*M3*M4*MZ4^2 - L3^2*M4^2*cos(q31L - q32L) - M3^2*MY3^2* ...
       cos(q31L - q32L) - M3^2*MZ3^2*cos(q31L - q32L) - M4^2*MY4^2* ...
       cos(q31L - q32L + q41L - q42L) - M4^2*MZ4^2*cos(q31L - q32L + ...
        q41L - q42L) - L3*M4^2*MZ4*cos(q31L - q32L + q41L) - L3*M4^2* ...
       MY4*sin(q31L - q32L + q41L) + 2*L3*M4^2*MZ4*cos(q41L) - L3*M4^2* ...
       MZ4*cos(q31L - q32L - q42L) + 2*L3*M4^2*MY4*sin(q41L) + L3*M4^2* ...
       MY4*sin(q31L - q32L - q42L) - 2*L3*M3*M4*MZ3 - M3*M4*MY3*MY4* ...
       cos(q31L - q32L + q41L) - M3*M4*MZ3*MZ4*cos(q31L - q32L + q41L) + ...
        M3*M4*MY3*MZ4*sin(q31L - q32L + q41L) - M3*M4*MY4*MZ3*sin(q31L - ...
        q32L + q41L) - M1*M4*MY1*MY4*cos(q31L + q41L) - M1*M4*MZ1*MZ4* ...
       cos(q31L + q41L) + M1*M4*MY1*MZ4*sin(q31L + q41L) - M1*M4*MY4* ...
       MZ1*sin(q31L + q41L) - L3*M1*M4*MZ1*cos(q31L) + 2*L3*M1*M4*MZ4* ...
       cos(q41L) + 4*L3*M3*M4*MZ4*cos(q41L) - M1*M3*MY1*MY3*cos(q31L) - ...
        2*M3*M4*MY3*MY4*cos(q41L) - M1*M3*MZ1*MZ3*cos(q31L) - 2*M3*M4* ...
       MZ3*MZ4*cos(q41L) - M3*M4*MY3*MY4*cos(q31L - q32L - q42L) - M3* ...
       M4*MZ3*MZ4*cos(q31L - q32L - q42L) + L3*M1*M4*MY1*sin(q31L) + 2* ...
       L3*M1*M4*MY4*sin(q41L) + 4*L3*M3*M4*MY4*sin(q41L) + M1*M3*MY1* ...
       MZ3*sin(q31L) - M1*M3*MY3*MZ1*sin(q31L) + 2*M3*M4*MY3*MZ4* ...
       sin(q41L) - 2*M3*M4*MY4*MZ3*sin(q41L) - M3*M4*MY3*MZ4*sin(q31L - ...
        q32L - q42L) + M3*M4*MY4*MZ3*sin(q31L - q32L - q42L) - 2*L3*M3* ...
       M4*MZ3*cos(q31L - q32L))/(M1 + 2*M3 + 2*M4);
D(2,1)=-(L3^2*M4^2*cos(q31L - q32L) + M3^2*MY3^2*cos(q31L - q32L) + ...
        M3^2*MZ3^2*cos(q31L - q32L) + M4^2*MY4^2*cos(q31L - q32L + ...
        q41L - q42L) + M4^2*MZ4^2*cos(q31L - q32L + q41L - q42L) + L3* ...
       M4^2*MZ4*cos(q31L - q32L + q41L) + L3*M4^2*MY4*sin(q31L - q32L + ...
        q41L) + L3*M4^2*MZ4*cos(q31L - q32L - q42L) - L3*M4^2*MY4* ...
       sin(q31L - q32L - q42L) + M3*M4*MY3*MY4*cos(q31L - q32L + q41L) + ...
        M3*M4*MZ3*MZ4*cos(q31L - q32L + q41L) - M3*M4*MY3*MZ4*sin(q31L - ...
        q32L + q41L) + M3*M4*MY4*MZ3*sin(q31L - q32L + q41L) + M3*M4* ...
       MY3*MY4*cos(q31L - q32L - q42L) + M3*M4*MZ3*MZ4*cos(q31L - q32L - ...
        q42L) + M3*M4*MY3*MZ4*sin(q31L - q32L - q42L) - M3*M4*MY4*MZ3* ...
       sin(q31L - q32L - q42L) + 2*L3*M3*M4*MZ3*cos(q31L - q32L))/(M1 + ...
        2*M3 + 2*M4);
D(2,2)=(M1*XX3 + M1*XX4 + 2*M3*XX3 + 2*M3*XX4 + 2*M4*XX3 + 2*M4*XX4 + ...
        L3^2*M4^2 + M3^2*MY3^2 + M4^2*MY4^2 + M3^2*MZ3^2 + M4^2*MZ4^2 + ...
        L3^2*M1*M4 + 2*L3^2*M3*M4 + M1*M3*MY3^2 + M1*M4*MY4^2 + 2*M3*M4* ...
       MY3^2 + 2*M3*M4*MY4^2 + M1*M3*MZ3^2 + M1*M4*MZ4^2 + 2*M3*M4* ...
       MZ3^2 + 2*M3*M4*MZ4^2 + 2*L3*M4^2*MZ4*cos(q42L) + 2*L3*M4^2*MY4* ...
       sin(q42L) - 2*L3*M3*M4*MZ3 + 2*L3*M1*M4*MZ4*cos(q42L) + 4*L3*M3* ...
       M4*MZ4*cos(q42L) - 2*M3*M4*MY3*MY4*cos(q42L) - 2*M3*M4*MZ3*MZ4* ...
       cos(q42L) + 2*L3*M1*M4*MY4*sin(q42L) + 4*L3*M3*M4*MY4*sin(q42L) + ...
        2*M3*M4*MY3*MZ4*sin(q42L) - 2*M3*M4*MY4*MZ3*sin(q42L))/(M1 + 2* ...
       M3 + 2*M4);
D(2,3)=-(M4^2*MY4^2*cos(q31L - q32L + q41L - q42L) + M4^2*MZ4^2* ...
       cos(q31L - q32L + q41L - q42L) + L3*M4^2*MZ4*cos(q31L - q32L + ...
        q41L) + L3*M4^2*MY4*sin(q31L - q32L + q41L) + M3*M4*MY3*MY4* ...
       cos(q31L - q32L + q41L) + M3*M4*MZ3*MZ4*cos(q31L - q32L + q41L) - ...
        M3*M4*MY3*MZ4*sin(q31L - q32L + q41L) + M3*M4*MY4*MZ3*sin(q31L - ...
        q32L + q41L))/(M1 + 2*M3 + 2*M4);
D(2,4)=(M1*XX4 + 2*M3*XX4 + 2*M4*XX4 + M4^2*MY4^2 + M4^2*MZ4^2 + M1*M4* ...
       MY4^2 + 2*M3*M4*MY4^2 + M1*M4*MZ4^2 + 2*M3*M4*MZ4^2 + L3*M4^2* ...
       MZ4*cos(q42L) + L3*M4^2*MY4*sin(q42L) + L3*M1*M4*MZ4*cos(q42L) + ...
        2*L3*M3*M4*MZ4*cos(q42L) - M3*M4*MY3*MY4*cos(q42L) - M3*M4*MZ3* ...
       MZ4*cos(q42L) + L3*M1*M4*MY4*sin(q42L) + 2*L3*M3*M4*MY4* ...
       sin(q42L) + M3*M4*MY3*MZ4*sin(q42L) - M3*M4*MY4*MZ3* ...
       sin(q42L))/(M1 + 2*M3 + 2*M4);
D(2,5)=(M1*XX3 + M1*XX4 + 2*M3*XX3 + 2*M3*XX4 + 2*M4*XX3 + 2*M4*XX4 + ...
        L3^2*M4^2 + M3^2*MY3^2 + M4^2*MY4^2 + M3^2*MZ3^2 + M4^2*MZ4^2 + ...
        L3^2*M1*M4 + 2*L3^2*M3*M4 + M1*M3*MY3^2 + M1*M4*MY4^2 + 2*M3*M4* ...
       MY3^2 + 2*M3*M4*MY4^2 + M1*M3*MZ3^2 + M1*M4*MZ4^2 + 2*M3*M4* ...
       MZ3^2 + 2*M3*M4*MZ4^2 - L3^2*M4^2*cos(q31L - q32L) - M3^2*MY3^2* ...
       cos(q31L - q32L) - M3^2*MZ3^2*cos(q31L - q32L) - M4^2*MY4^2* ...
       cos(q31L - q32L + q41L - q42L) - M4^2*MZ4^2*cos(q31L - q32L + ...
        q41L - q42L) - L3*M4^2*MZ4*cos(q31L - q32L + q41L) - L3*M4^2* ...
       MY4*sin(q31L - q32L + q41L) + 2*L3*M4^2*MZ4*cos(q42L) - L3*M4^2* ...
       MZ4*cos(q31L - q32L - q42L) + 2*L3*M4^2*MY4*sin(q42L) + L3*M4^2* ...
       MY4*sin(q31L - q32L - q42L) - 2*L3*M3*M4*MZ3 - M3*M4*MY3*MY4* ...
       cos(q31L - q32L + q41L) - M3*M4*MZ3*MZ4*cos(q31L - q32L + q41L) + ...
        M3*M4*MY3*MZ4*sin(q31L - q32L + q41L) - M3*M4*MY4*MZ3*sin(q31L - ...
        q32L + q41L) - M1*M4*MY1*MY4*cos(q32L + q42L) - M1*M4*MZ1*MZ4* ...
       cos(q32L + q42L) + M1*M4*MY1*MZ4*sin(q32L + q42L) - M1*M4*MY4* ...
       MZ1*sin(q32L + q42L) - L3*M1*M4*MZ1*cos(q32L) + 2*L3*M1*M4*MZ4* ...
       cos(q42L) + 4*L3*M3*M4*MZ4*cos(q42L) - M1*M3*MY1*MY3*cos(q32L) - ...
        2*M3*M4*MY3*MY4*cos(q42L) - M1*M3*MZ1*MZ3*cos(q32L) - 2*M3*M4* ...
       MZ3*MZ4*cos(q42L) - M3*M4*MY3*MY4*cos(q31L - q32L - q42L) - M3* ...
       M4*MZ3*MZ4*cos(q31L - q32L - q42L) + L3*M1*M4*MY1*sin(q32L) + 2* ...
       L3*M1*M4*MY4*sin(q42L) + 4*L3*M3*M4*MY4*sin(q42L) + M1*M3*MY1* ...
       MZ3*sin(q32L) - M1*M3*MY3*MZ1*sin(q32L) + 2*M3*M4*MY3*MZ4* ...
       sin(q42L) - 2*M3*M4*MY4*MZ3*sin(q42L) - M3*M4*MY3*MZ4*sin(q31L - ...
        q32L - q42L) + M3*M4*MY4*MZ3*sin(q31L - q32L - q42L) - 2*L3*M3* ...
       M4*MZ3*cos(q31L - q32L))/(M1 + 2*M3 + 2*M4);
D(3,1)=(M1*XX4 + 2*M3*XX4 + 2*M4*XX4 + M4^2*MY4^2 + M4^2*MZ4^2 + M1*M4* ...
       MY4^2 + 2*M3*M4*MY4^2 + M1*M4*MZ4^2 + 2*M3*M4*MZ4^2 + L3*M4^2* ...
       MZ4*cos(q41L) + L3*M4^2*MY4*sin(q41L) + L3*M1*M4*MZ4*cos(q41L) + ...
        2*L3*M3*M4*MZ4*cos(q41L) - M3*M4*MY3*MY4*cos(q41L) - M3*M4*MZ3* ...
       MZ4*cos(q41L) + L3*M1*M4*MY4*sin(q41L) + 2*L3*M3*M4*MY4* ...
       sin(q41L) + M3*M4*MY3*MZ4*sin(q41L) - M3*M4*MY4*MZ3* ...
       sin(q41L))/(M1 + 2*M3 + 2*M4);
D(3,2)=-(M4*(M4*MY4^2*cos(q31L - q32L + q41L - q42L) + M4*MZ4^2* ...
       cos(q31L - q32L + q41L - q42L) + L3*M4*MZ4*cos(q31L - q32L + ...
        q41L) + M3*MY3*MY4*cos(q31L - q32L + q41L) + M3*MZ3*MZ4* ...
       cos(q31L - q32L + q41L) + L3*M4*MY4*sin(q31L - q32L + q41L) - M3* ...
       MY3*MZ4*sin(q31L - q32L + q41L) + M3*MY4*MZ3*sin(q31L - q32L + ...
        q41L)))/(M1 + 2*M3 + 2*M4);
D(3,3)=(M1*XX4 + 2*M3*XX4 + 2*M4*XX4 + M4^2*MY4^2 + M4^2*MZ4^2 + M1*M4* ...
       MY4^2 + 2*M3*M4*MY4^2 + M1*M4*MZ4^2 + 2*M3*M4*MZ4^2)/(M1 + 2*M3 + ...
        2*M4);
D(3,4)=-(M4^2*MY4^2*cos(q31L - q32L + q41L - q42L) + M4^2*MZ4^2* ...
       cos(q31L - q32L + q41L - q42L))/(M1 + 2*M3 + 2*M4);
D(3,5)=(M1*XX4 + 2*M3*XX4 + 2*M4*XX4 + M4^2*MY4^2 + M4^2*MZ4^2 + M1*M4* ...
       MY4^2 + 2*M3*M4*MY4^2 + M1*M4*MZ4^2 + 2*M3*M4*MZ4^2 - M4^2*MY4^2* ...
       cos(q31L - q32L + q41L - q42L) - M4^2*MZ4^2*cos(q31L - q32L + ...
        q41L - q42L) - L3*M4^2*MZ4*cos(q31L - q32L + q41L) - L3*M4^2* ...
       MY4*sin(q31L - q32L + q41L) + L3*M4^2*MZ4*cos(q41L) + L3*M4^2* ...
       MY4*sin(q41L) - M3*M4*MY3*MY4*cos(q31L - q32L + q41L) - M3*M4* ...
       MZ3*MZ4*cos(q31L - q32L + q41L) + M3*M4*MY3*MZ4*sin(q31L - q32L + ...
        q41L) - M3*M4*MY4*MZ3*sin(q31L - q32L + q41L) - M1*M4*MY1*MY4* ...
       cos(q31L + q41L) - M1*M4*MZ1*MZ4*cos(q31L + q41L) + M1*M4*MY1* ...
       MZ4*sin(q31L + q41L) - M1*M4*MY4*MZ1*sin(q31L + q41L) + L3*M1*M4* ...
       MZ4*cos(q41L) + 2*L3*M3*M4*MZ4*cos(q41L) - M3*M4*MY3*MY4* ...
       cos(q41L) - M3*M4*MZ3*MZ4*cos(q41L) + L3*M1*M4*MY4*sin(q41L) + 2* ...
       L3*M3*M4*MY4*sin(q41L) + M3*M4*MY3*MZ4*sin(q41L) - M3*M4*MY4*MZ3* ...
       sin(q41L))/(M1 + 2*M3 + 2*M4);
D(4,1)=-(M4*(M4*MY4^2*cos(q31L - q32L + q41L - q42L) + M4*MZ4^2* ...
       cos(q31L - q32L + q41L - q42L) + L3*M4*MZ4*cos(q31L - q32L - ...
        q42L) + M3*MY3*MY4*cos(q31L - q32L - q42L) + M3*MZ3*MZ4* ...
       cos(q31L - q32L - q42L) - L3*M4*MY4*sin(q31L - q32L - q42L) + M3* ...
       MY3*MZ4*sin(q31L - q32L - q42L) - M3*MY4*MZ3*sin(q31L - q32L - ...
        q42L)))/(M1 + 2*M3 + 2*M4);
D(4,2)=(M1*XX4 + 2*M3*XX4 + 2*M4*XX4 + M4^2*MY4^2 + M4^2*MZ4^2 + M1*M4* ...
       MY4^2 + 2*M3*M4*MY4^2 + M1*M4*MZ4^2 + 2*M3*M4*MZ4^2 + L3*M4^2* ...
       MZ4*cos(q42L) + L3*M4^2*MY4*sin(q42L) + L3*M1*M4*MZ4*cos(q42L) + ...
        2*L3*M3*M4*MZ4*cos(q42L) - M3*M4*MY3*MY4*cos(q42L) - M3*M4*MZ3* ...
       MZ4*cos(q42L) + L3*M1*M4*MY4*sin(q42L) + 2*L3*M3*M4*MY4* ...
       sin(q42L) + M3*M4*MY3*MZ4*sin(q42L) - M3*M4*MY4*MZ3* ...
       sin(q42L))/(M1 + 2*M3 + 2*M4);
D(4,3)=-(M4^2*cos(q31L - q32L + q41L - q42L)*(MY4^2 + MZ4^2))/(M1 + 2* ...
       M3 + 2*M4);
D(4,4)=(M1*XX4 + 2*M3*XX4 + 2*M4*XX4 + M4^2*MY4^2 + M4^2*MZ4^2 + M1*M4* ...
       MY4^2 + 2*M3*M4*MY4^2 + M1*M4*MZ4^2 + 2*M3*M4*MZ4^2)/(M1 + 2*M3 + ...
        2*M4);
D(4,5)=(M1*XX4 + 2*M3*XX4 + 2*M4*XX4 + M4^2*MY4^2 + M4^2*MZ4^2 + M1*M4* ...
       MY4^2 + 2*M3*M4*MY4^2 + M1*M4*MZ4^2 + 2*M3*M4*MZ4^2 - M4^2*MY4^2* ...
       cos(q31L - q32L + q41L - q42L) - M4^2*MZ4^2*cos(q31L - q32L + ...
        q41L - q42L) + L3*M4^2*MZ4*cos(q42L) - L3*M4^2*MZ4*cos(q31L - ...
        q32L - q42L) + L3*M4^2*MY4*sin(q42L) + L3*M4^2*MY4*sin(q31L - ...
        q32L - q42L) - M1*M4*MY1*MY4*cos(q32L + q42L) - M1*M4*MZ1*MZ4* ...
       cos(q32L + q42L) + M1*M4*MY1*MZ4*sin(q32L + q42L) - M1*M4*MY4* ...
       MZ1*sin(q32L + q42L) + L3*M1*M4*MZ4*cos(q42L) + 2*L3*M3*M4*MZ4* ...
       cos(q42L) - M3*M4*MY3*MY4*cos(q42L) - M3*M4*MZ3*MZ4*cos(q42L) - ...
        M3*M4*MY3*MY4*cos(q31L - q32L - q42L) - M3*M4*MZ3*MZ4*cos(q31L - ...
        q32L - q42L) + L3*M1*M4*MY4*sin(q42L) + 2*L3*M3*M4*MY4* ...
       sin(q42L) + M3*M4*MY3*MZ4*sin(q42L) - M3*M4*MY4*MZ3*sin(q42L) - ...
        M3*M4*MY3*MZ4*sin(q31L - q32L - q42L) + M3*M4*MY4*MZ3*sin(q31L - ...
        q32L - q42L))/(M1 + 2*M3 + 2*M4);
D(5,1)=(M1*XX3 + M1*XX4 + 2*M3*XX3 + 2*M3*XX4 + 2*M4*XX3 + 2*M4*XX4 + ...
        L3^2*M4^2 + M3^2*MY3^2 + M4^2*MY4^2 + M3^2*MZ3^2 + M4^2*MZ4^2 + ...
        L3^2*M1*M4 + 2*L3^2*M3*M4 + M1*M3*MY3^2 + M1*M4*MY4^2 + 2*M3*M4* ...
       MY3^2 + 2*M3*M4*MY4^2 + M1*M3*MZ3^2 + M1*M4*MZ4^2 + 2*M3*M4* ...
       MZ3^2 + 2*M3*M4*MZ4^2 - L3^2*M4^2*cos(q31L - q32L) - M3^2*MY3^2* ...
       cos(q31L - q32L) - M3^2*MZ3^2*cos(q31L - q32L) - M4^2*MY4^2* ...
       cos(q31L - q32L + q41L - q42L) - M4^2*MZ4^2*cos(q31L - q32L + ...
        q41L - q42L) - L3*M4^2*MZ4*cos(q31L - q32L + q41L) - L3*M4^2* ...
       MY4*sin(q31L - q32L + q41L) + 2*L3*M4^2*MZ4*cos(q41L) - L3*M4^2* ...
       MZ4*cos(q31L - q32L - q42L) + 2*L3*M4^2*MY4*sin(q41L) + L3*M4^2* ...
       MY4*sin(q31L - q32L - q42L) - 2*L3*M3*M4*MZ3 - M3*M4*MY3*MY4* ...
       cos(q31L - q32L + q41L) - M3*M4*MZ3*MZ4*cos(q31L - q32L + q41L) + ...
        M3*M4*MY3*MZ4*sin(q31L - q32L + q41L) - M3*M4*MY4*MZ3*sin(q31L - ...
        q32L + q41L) - M1*M4*MY1*MY4*cos(q31L + q41L) - M1*M4*MZ1*MZ4* ...
       cos(q31L + q41L) + M1*M4*MY1*MZ4*sin(q31L + q41L) - M1*M4*MY4* ...
       MZ1*sin(q31L + q41L) - L3*M1*M4*MZ1*cos(q31L) + 2*L3*M1*M4*MZ4* ...
       cos(q41L) + 4*L3*M3*M4*MZ4*cos(q41L) - M1*M3*MY1*MY3*cos(q31L) - ...
        2*M3*M4*MY3*MY4*cos(q41L) - M1*M3*MZ1*MZ3*cos(q31L) - 2*M3*M4* ...
       MZ3*MZ4*cos(q41L) - M3*M4*MY3*MY4*cos(q31L - q32L - q42L) - M3* ...
       M4*MZ3*MZ4*cos(q31L - q32L - q42L) + L3*M1*M4*MY1*sin(q31L) + 2* ...
       L3*M1*M4*MY4*sin(q41L) + 4*L3*M3*M4*MY4*sin(q41L) + M1*M3*MY1* ...
       MZ3*sin(q31L) - M1*M3*MY3*MZ1*sin(q31L) + 2*M3*M4*MY3*MZ4* ...
       sin(q41L) - 2*M3*M4*MY4*MZ3*sin(q41L) - M3*M4*MY3*MZ4*sin(q31L - ...
        q32L - q42L) + M3*M4*MY4*MZ3*sin(q31L - q32L - q42L) - 2*L3*M3* ...
       M4*MZ3*cos(q31L - q32L))/(M1 + 2*M3 + 2*M4);
D(5,2)=(M1*XX3 + M1*XX4 + 2*M3*XX3 + 2*M3*XX4 + 2*M4*XX3 + 2*M4*XX4 + ...
        L3^2*M4^2 + M3^2*MY3^2 + M4^2*MY4^2 + M3^2*MZ3^2 + M4^2*MZ4^2 + ...
        L3^2*M1*M4 + 2*L3^2*M3*M4 + M1*M3*MY3^2 + M1*M4*MY4^2 + 2*M3*M4* ...
       MY3^2 + 2*M3*M4*MY4^2 + M1*M3*MZ3^2 + M1*M4*MZ4^2 + 2*M3*M4* ...
       MZ3^2 + 2*M3*M4*MZ4^2 - L3^2*M4^2*cos(q31L - q32L) - M3^2*MY3^2* ...
       cos(q31L - q32L) - M3^2*MZ3^2*cos(q31L - q32L) - M4^2*MY4^2* ...
       cos(q31L - q32L + q41L - q42L) - M4^2*MZ4^2*cos(q31L - q32L + ...
        q41L - q42L) - L3*M4^2*MZ4*cos(q31L - q32L + q41L) - L3*M4^2* ...
       MY4*sin(q31L - q32L + q41L) + 2*L3*M4^2*MZ4*cos(q42L) - L3*M4^2* ...
       MZ4*cos(q31L - q32L - q42L) + 2*L3*M4^2*MY4*sin(q42L) + L3*M4^2* ...
       MY4*sin(q31L - q32L - q42L) - 2*L3*M3*M4*MZ3 - M3*M4*MY3*MY4* ...
       cos(q31L - q32L + q41L) - M3*M4*MZ3*MZ4*cos(q31L - q32L + q41L) + ...
        M3*M4*MY3*MZ4*sin(q31L - q32L + q41L) - M3*M4*MY4*MZ3*sin(q31L - ...
        q32L + q41L) - M1*M4*MY1*MY4*cos(q32L + q42L) - M1*M4*MZ1*MZ4* ...
       cos(q32L + q42L) + M1*M4*MY1*MZ4*sin(q32L + q42L) - M1*M4*MY4* ...
       MZ1*sin(q32L + q42L) - L3*M1*M4*MZ1*cos(q32L) + 2*L3*M1*M4*MZ4* ...
       cos(q42L) + 4*L3*M3*M4*MZ4*cos(q42L) - M1*M3*MY1*MY3*cos(q32L) - ...
        2*M3*M4*MY3*MY4*cos(q42L) - M1*M3*MZ1*MZ3*cos(q32L) - 2*M3*M4* ...
       MZ3*MZ4*cos(q42L) - M3*M4*MY3*MY4*cos(q31L - q32L - q42L) - M3* ...
       M4*MZ3*MZ4*cos(q31L - q32L - q42L) + L3*M1*M4*MY1*sin(q32L) + 2* ...
       L3*M1*M4*MY4*sin(q42L) + 4*L3*M3*M4*MY4*sin(q42L) + M1*M3*MY1* ...
       MZ3*sin(q32L) - M1*M3*MY3*MZ1*sin(q32L) + 2*M3*M4*MY3*MZ4* ...
       sin(q42L) - 2*M3*M4*MY4*MZ3*sin(q42L) - M3*M4*MY3*MZ4*sin(q31L - ...
        q32L - q42L) + M3*M4*MY4*MZ3*sin(q31L - q32L - q42L) - 2*L3*M3* ...
       M4*MZ3*cos(q31L - q32L))/(M1 + 2*M3 + 2*M4);
D(5,3)=(M1*XX4 + 2*M3*XX4 + 2*M4*XX4 + M4^2*MY4^2 + M4^2*MZ4^2 + M1*M4* ...
       MY4^2 + 2*M3*M4*MY4^2 + M1*M4*MZ4^2 + 2*M3*M4*MZ4^2 - M4^2*MY4^2* ...
       cos(q31L - q32L + q41L - q42L) - M4^2*MZ4^2*cos(q31L - q32L + ...
        q41L - q42L) - L3*M4^2*MZ4*cos(q31L - q32L + q41L) - L3*M4^2* ...
       MY4*sin(q31L - q32L + q41L) + L3*M4^2*MZ4*cos(q41L) + L3*M4^2* ...
       MY4*sin(q41L) - M3*M4*MY3*MY4*cos(q31L - q32L + q41L) - M3*M4* ...
       MZ3*MZ4*cos(q31L - q32L + q41L) + M3*M4*MY3*MZ4*sin(q31L - q32L + ...
        q41L) - M3*M4*MY4*MZ3*sin(q31L - q32L + q41L) - M1*M4*MY1*MY4* ...
       cos(q31L + q41L) - M1*M4*MZ1*MZ4*cos(q31L + q41L) + M1*M4*MY1* ...
       MZ4*sin(q31L + q41L) - M1*M4*MY4*MZ1*sin(q31L + q41L) + L3*M1*M4* ...
       MZ4*cos(q41L) + 2*L3*M3*M4*MZ4*cos(q41L) - M3*M4*MY3*MY4* ...
       cos(q41L) - M3*M4*MZ3*MZ4*cos(q41L) + L3*M1*M4*MY4*sin(q41L) + 2* ...
       L3*M3*M4*MY4*sin(q41L) + M3*M4*MY3*MZ4*sin(q41L) - M3*M4*MY4*MZ3* ...
       sin(q41L))/(M1 + 2*M3 + 2*M4);
D(5,4)=(M1*XX4 + 2*M3*XX4 + 2*M4*XX4 + M4^2*MY4^2 + M4^2*MZ4^2 + M1*M4* ...
       MY4^2 + 2*M3*M4*MY4^2 + M1*M4*MZ4^2 + 2*M3*M4*MZ4^2 - M4^2*MY4^2* ...
       cos(q31L - q32L + q41L - q42L) - M4^2*MZ4^2*cos(q31L - q32L + ...
        q41L - q42L) + L3*M4^2*MZ4*cos(q42L) - L3*M4^2*MZ4*cos(q31L - ...
        q32L - q42L) + L3*M4^2*MY4*sin(q42L) + L3*M4^2*MY4*sin(q31L - ...
        q32L - q42L) - M1*M4*MY1*MY4*cos(q32L + q42L) - M1*M4*MZ1*MZ4* ...
       cos(q32L + q42L) + M1*M4*MY1*MZ4*sin(q32L + q42L) - M1*M4*MY4* ...
       MZ1*sin(q32L + q42L) + L3*M1*M4*MZ4*cos(q42L) + 2*L3*M3*M4*MZ4* ...
       cos(q42L) - M3*M4*MY3*MY4*cos(q42L) - M3*M4*MZ3*MZ4*cos(q42L) - ...
        M3*M4*MY3*MY4*cos(q31L - q32L - q42L) - M3*M4*MZ3*MZ4*cos(q31L - ...
        q32L - q42L) + L3*M1*M4*MY4*sin(q42L) + 2*L3*M3*M4*MY4* ...
       sin(q42L) + M3*M4*MY3*MZ4*sin(q42L) - M3*M4*MY4*MZ3*sin(q42L) - ...
        M3*M4*MY3*MZ4*sin(q31L - q32L - q42L) + M3*M4*MY4*MZ3*sin(q31L - ...
        q32L - q42L))/(M1 + 2*M3 + 2*M4);
D(5,5)=(M1*XX1 + 2*M1*XX3 + 2*M3*XX1 + 2*M1*XX4 + 2*M4*XX1 + 4*M3*XX3 + ...
        4*M3*XX4 + 4*M4*XX3 + 4*M4*XX4 + 2*L3^2*M4^2 + 2*M3^2*MY3^2 + 2* ...
       M4^2*MY4^2 + 2*M3^2*MZ3^2 + 2*M4^2*MZ4^2 + 2*L3^2*M1*M4 + 4*L3^2* ...
       M3*M4 + 2*M1*M3*MY1^2 + 2*M1*M4*MY1^2 + 2*M1*M3*MY3^2 + 2*M1*M4* ...
       MY4^2 + 4*M3*M4*MY3^2 + 4*M3*M4*MY4^2 + 2*M1*M3*MZ1^2 + 2*M1*M4* ...
       MZ1^2 + 2*M1*M3*MZ3^2 + 2*M1*M4*MZ4^2 + 4*M3*M4*MZ3^2 + 4*M3*M4* ...
       MZ4^2 - 2*L3^2*M4^2*cos(q31L - q32L) - 2*M3^2*MY3^2*cos(q31L - ...
        q32L) - 2*M3^2*MZ3^2*cos(q31L - q32L) - 2*M4^2*MY4^2*cos(q31L - ...
        q32L + q41L - q42L) - 2*M4^2*MZ4^2*cos(q31L - q32L + q41L - ...
        q42L) - 2*L3*M4^2*MZ4*cos(q31L - q32L + q41L) - 2*L3*M4^2*MY4* ...
       sin(q31L - q32L + q41L) + 2*L3*M4^2*MZ4*cos(q41L) + 2*L3*M4^2* ...
       MZ4*cos(q42L) - 2*L3*M4^2*MZ4*cos(q31L - q32L - q42L) + 2*L3* ...
       M4^2*MY4*sin(q41L) + 2*L3*M4^2*MY4*sin(q42L) + 2*L3*M4^2*MY4* ...
       sin(q31L - q32L - q42L) - 4*L3*M3*M4*MZ3 - 2*M3*M4*MY3*MY4* ...
       cos(q31L - q32L + q41L) - 2*M3*M4*MZ3*MZ4*cos(q31L - q32L + ...
        q41L) + 2*M3*M4*MY3*MZ4*sin(q31L - q32L + q41L) - 2*M3*M4*MY4* ...
       MZ3*sin(q31L - q32L + q41L) - 2*M1*M4*MY1*MY4*cos(q31L + q41L) - ...
        2*M1*M4*MY1*MY4*cos(q32L + q42L) - 2*M1*M4*MZ1*MZ4*cos(q31L + ...
        q41L) - 2*M1*M4*MZ1*MZ4*cos(q32L + q42L) + 2*M1*M4*MY1*MZ4* ...
       sin(q31L + q41L) - 2*M1*M4*MY4*MZ1*sin(q31L + q41L) + 2*M1*M4* ...
       MY1*MZ4*sin(q32L + q42L) - 2*M1*M4*MY4*MZ1*sin(q32L + q42L) - 2* ...
       L3*M1*M4*MZ1*cos(q31L) - 2*L3*M1*M4*MZ1*cos(q32L) + 2*L3*M1*M4* ...
       MZ4*cos(q41L) + 2*L3*M1*M4*MZ4*cos(q42L) + 4*L3*M3*M4*MZ4* ...
       cos(q41L) + 4*L3*M3*M4*MZ4*cos(q42L) - 2*M1*M3*MY1*MY3* ...
       cos(q31L) - 2*M1*M3*MY1*MY3*cos(q32L) - 2*M3*M4*MY3*MY4* ...
       cos(q41L) - 2*M3*M4*MY3*MY4*cos(q42L) - 2*M1*M3*MZ1*MZ3* ...
       cos(q31L) - 2*M1*M3*MZ1*MZ3*cos(q32L) - 2*M3*M4*MZ3*MZ4* ...
       cos(q41L) - 2*M3*M4*MZ3*MZ4*cos(q42L) - 2*M3*M4*MY3*MY4* ...
       cos(q31L - q32L - q42L) - 2*M3*M4*MZ3*MZ4*cos(q31L - q32L - ...
        q42L) + 2*L3*M1*M4*MY1*sin(q31L) + 2*L3*M1*M4*MY1*sin(q32L) + 2* ...
       L3*M1*M4*MY4*sin(q41L) + 2*L3*M1*M4*MY4*sin(q42L) + 4*L3*M3*M4* ...
       MY4*sin(q41L) + 4*L3*M3*M4*MY4*sin(q42L) + 2*M1*M3*MY1*MZ3* ...
       sin(q31L) - 2*M1*M3*MY3*MZ1*sin(q31L) + 2*M1*M3*MY1*MZ3* ...
       sin(q32L) - 2*M1*M3*MY3*MZ1*sin(q32L) + 2*M3*M4*MY3*MZ4* ...
       sin(q41L) - 2*M3*M4*MY4*MZ3*sin(q41L) + 2*M3*M4*MY3*MZ4* ...
       sin(q42L) - 2*M3*M4*MY4*MZ3*sin(q42L) - 2*M3*M4*MY3*MZ4* ...
       sin(q31L - q32L - q42L) + 2*M3*M4*MY4*MZ3*sin(q31L - q32L - ...
        q42L) - 4*L3*M3*M4*MZ3*cos(q31L - q32L))/(M1 + 2*M3 + 2*M4);
D(6,6)=M1 + 2*M3 + 2*M4;
D(7,7)=M1 + 2*M3 + 2*M4;

% C matrix
C=zeros(7);
C(1,1)=(M4*dq41L*(L3*M1*MY4*cos(q41L) + 2*L3*M3*MY4*cos(q41L) + L3*M4* ...
       MY4*cos(q41L) + M3*MY3*MZ4*cos(q41L) - M3*MY4*MZ3*cos(q41L) - L3* ...
       M1*MZ4*sin(q41L) - 2*L3*M3*MZ4*sin(q41L) - L3*M4*MZ4*sin(q41L) + ...
        M3*MY3*MY4*sin(q41L) + M3*MZ3*MZ4*sin(q41L)))/(M1 + 2*M3 + 2*M4);
C(1,2)=-(L3^2*M4^2*dq1L*sin(q31L - q32L) + L3^2*M4^2*dq32L*sin(q31L - ...
        q32L) + M3^2*MY3^2*dq1L*sin(q31L - q32L) + M3^2*MY3^2*dq32L* ...
       sin(q31L - q32L) + M3^2*MZ3^2*dq1L*sin(q31L - q32L) + M3^2*MZ3^2* ...
       dq32L*sin(q31L - q32L) + M4^2*MY4^2*dq1L*sin(q31L - q32L + q41L - ...
        q42L) + M4^2*MY4^2*dq32L*sin(q31L - q32L + q41L - q42L) + M4^2* ...
       MY4^2*dq42L*sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq1L* ...
       sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq32L*sin(q31L - ...
        q32L + q41L - q42L) + M4^2*MZ4^2*dq42L*sin(q31L - q32L + q41L - ...
        q42L) - L3*M4^2*MY4*dq1L*cos(q31L - q32L + q41L) - L3*M4^2*MY4* ...
       dq32L*cos(q31L - q32L + q41L) + L3*M4^2*MZ4*dq1L*sin(q31L - ...
        q32L + q41L) + L3*M4^2*MZ4*dq32L*sin(q31L - q32L + q41L) + L3* ...
       M4^2*MY4*dq1L*cos(q31L - q32L - q42L) + L3*M4^2*MY4*dq32L* ...
       cos(q31L - q32L - q42L) + L3*M4^2*MY4*dq42L*cos(q31L - q32L - ...
        q42L) + L3*M4^2*MZ4*dq1L*sin(q31L - q32L - q42L) + L3*M4^2*MZ4* ...
       dq32L*sin(q31L - q32L - q42L) + L3*M4^2*MZ4*dq42L*sin(q31L - ...
        q32L - q42L) + 2*L3*M3*M4*MZ3*dq1L*sin(q31L - q32L) + 2*L3*M3* ...
       M4*MZ3*dq32L*sin(q31L - q32L) + M3*M4*MY3*MZ4*dq1L*cos(q31L - ...
        q32L + q41L) - M3*M4*MY4*MZ3*dq1L*cos(q31L - q32L + q41L) + M3* ...
       M4*MY3*MZ4*dq32L*cos(q31L - q32L + q41L) - M3*M4*MY4*MZ3*dq32L* ...
       cos(q31L - q32L + q41L) + M3*M4*MY3*MY4*dq1L*sin(q31L - q32L + ...
        q41L) + M3*M4*MY3*MY4*dq32L*sin(q31L - q32L + q41L) + M3*M4*MZ3* ...
       MZ4*dq1L*sin(q31L - q32L + q41L) + M3*M4*MZ3*MZ4*dq32L*sin(q31L - ...
        q32L + q41L) - M3*M4*MY3*MZ4*dq1L*cos(q31L - q32L - q42L) + M3* ...
       M4*MY4*MZ3*dq1L*cos(q31L - q32L - q42L) - M3*M4*MY3*MZ4*dq32L* ...
       cos(q31L - q32L - q42L) + M3*M4*MY4*MZ3*dq32L*cos(q31L - q32L - ...
        q42L) - M3*M4*MY3*MZ4*dq42L*cos(q31L - q32L - q42L) + M3*M4*MY4* ...
       MZ3*dq42L*cos(q31L - q32L - q42L) + M3*M4*MY3*MY4*dq1L*sin(q31L - ...
        q32L - q42L) + M3*M4*MY3*MY4*dq32L*sin(q31L - q32L - q42L) + M3* ...
       M4*MY3*MY4*dq42L*sin(q31L - q32L - q42L) + M3*M4*MZ3*MZ4*dq1L* ...
       sin(q31L - q32L - q42L) + M3*M4*MZ3*MZ4*dq32L*sin(q31L - q32L - ...
        q42L) + M3*M4*MZ3*MZ4*dq42L*sin(q31L - q32L - q42L))/(M1 + 2* ...
       M3 + 2*M4);
C(1,3)=(M4*(dq1L + dq31L + dq41L)*(L3*M1*MY4*cos(q41L) + 2*L3*M3*MY4* ...
       cos(q41L) + L3*M4*MY4*cos(q41L) + M3*MY3*MZ4*cos(q41L) - M3*MY4* ...
       MZ3*cos(q41L) - L3*M1*MZ4*sin(q41L) - 2*L3*M3*MZ4*sin(q41L) - L3* ...
       M4*MZ4*sin(q41L) + M3*MY3*MY4*sin(q41L) + M3*MZ3*MZ4* ...
       sin(q41L)))/(M1 + 2*M3 + 2*M4);
C(1,4)=-(M4*(dq1L + dq32L + dq42L)*(M4*MY4^2*sin(q31L - q32L + q41L - ...
        q42L) + M4*MZ4^2*sin(q31L - q32L + q41L - q42L) + L3*M4*MY4* ...
       cos(q31L - q32L - q42L) - M3*MY3*MZ4*cos(q31L - q32L - q42L) + ...
        M3*MY4*MZ3*cos(q31L - q32L - q42L) + L3*M4*MZ4*sin(q31L - q32L - ...
        q42L) + M3*MY3*MY4*sin(q31L - q32L - q42L) + M3*MZ3*MZ4* ...
       sin(q31L - q32L - q42L)))/(M1 + 2*M3 + 2*M4);
C(1,5)=-(L3^2*M4^2*dq1L*sin(q31L - q32L) + L3^2*M4^2*dq32L*sin(q31L - ...
        q32L) + M3^2*MY3^2*dq1L*sin(q31L - q32L) + M3^2*MY3^2*dq32L* ...
       sin(q31L - q32L) + M3^2*MZ3^2*dq1L*sin(q31L - q32L) + M3^2*MZ3^2* ...
       dq32L*sin(q31L - q32L) + M4^2*MY4^2*dq1L*sin(q31L - q32L + q41L - ...
        q42L) + M4^2*MY4^2*dq32L*sin(q31L - q32L + q41L - q42L) + M4^2* ...
       MY4^2*dq42L*sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq1L* ...
       sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq32L*sin(q31L - ...
        q32L + q41L - q42L) + M4^2*MZ4^2*dq42L*sin(q31L - q32L + q41L - ...
        q42L) - L3*M4^2*MY4*dq1L*cos(q31L - q32L + q41L) - L3*M4^2*MY4* ...
       dq32L*cos(q31L - q32L + q41L) + L3*M4^2*MZ4*dq1L*sin(q31L - ...
        q32L + q41L) + L3*M4^2*MZ4*dq32L*sin(q31L - q32L + q41L) - L3* ...
       M4^2*MY4*dq41L*cos(q41L) + L3*M4^2*MY4*dq1L*cos(q31L - q32L - ...
        q42L) + L3*M4^2*MY4*dq32L*cos(q31L - q32L - q42L) + L3*M4^2*MY4* ...
       dq42L*cos(q31L - q32L - q42L) + L3*M4^2*MZ4*dq41L*sin(q41L) + L3* ...
       M4^2*MZ4*dq1L*sin(q31L - q32L - q42L) + L3*M4^2*MZ4*dq32L* ...
       sin(q31L - q32L - q42L) + L3*M4^2*MZ4*dq42L*sin(q31L - q32L - ...
        q42L) + 2*L3*M3*M4*MZ3*dq1L*sin(q31L - q32L) + 2*L3*M3*M4*MZ3* ...
       dq32L*sin(q31L - q32L) + M3*M4*MY3*MZ4*dq1L*cos(q31L - q32L + ...
        q41L) - M3*M4*MY4*MZ3*dq1L*cos(q31L - q32L + q41L) + M3*M4*MY3* ...
       MZ4*dq32L*cos(q31L - q32L + q41L) - M3*M4*MY4*MZ3*dq32L* ...
       cos(q31L - q32L + q41L) + M3*M4*MY3*MY4*dq1L*sin(q31L - q32L + ...
        q41L) + M3*M4*MY3*MY4*dq32L*sin(q31L - q32L + q41L) + M3*M4*MZ3* ...
       MZ4*dq1L*sin(q31L - q32L + q41L) + M3*M4*MZ3*MZ4*dq32L*sin(q31L - ...
        q32L + q41L) + M1*M4*MY1*MZ4*dq1L*cos(q31L + q41L) - M1*M4*MY4* ...
       MZ1*dq1L*cos(q31L + q41L) + M1*M4*MY1*MY4*dq1L*sin(q31L + q41L) + ...
        M1*M4*MZ1*MZ4*dq1L*sin(q31L + q41L) + L3*M1*M4*MY1*dq1L* ...
       cos(q31L) - L3*M1*M4*MY4*dq41L*cos(q41L) - 2*L3*M3*M4*MY4*dq41L* ...
       cos(q41L) + M1*M3*MY1*MZ3*dq1L*cos(q31L) - M1*M3*MY3*MZ1*dq1L* ...
       cos(q31L) - M3*M4*MY3*MZ4*dq41L*cos(q41L) + M3*M4*MY4*MZ3*dq41L* ...
       cos(q41L) - M3*M4*MY3*MZ4*dq1L*cos(q31L - q32L - q42L) + M3*M4* ...
       MY4*MZ3*dq1L*cos(q31L - q32L - q42L) - M3*M4*MY3*MZ4*dq32L* ...
       cos(q31L - q32L - q42L) + M3*M4*MY4*MZ3*dq32L*cos(q31L - q32L - ...
        q42L) - M3*M4*MY3*MZ4*dq42L*cos(q31L - q32L - q42L) + M3*M4*MY4* ...
       MZ3*dq42L*cos(q31L - q32L - q42L) + L3*M1*M4*MZ1*dq1L*sin(q31L) + ...
        L3*M1*M4*MZ4*dq41L*sin(q41L) + 2*L3*M3*M4*MZ4*dq41L*sin(q41L) + ...
        M1*M3*MY1*MY3*dq1L*sin(q31L) - M3*M4*MY3*MY4*dq41L*sin(q41L) + ...
        M1*M3*MZ1*MZ3*dq1L*sin(q31L) - M3*M4*MZ3*MZ4*dq41L*sin(q41L) + ...
        M3*M4*MY3*MY4*dq1L*sin(q31L - q32L - q42L) + M3*M4*MY3*MY4* ...
       dq32L*sin(q31L - q32L - q42L) + M3*M4*MY3*MY4*dq42L*sin(q31L - ...
        q32L - q42L) + M3*M4*MZ3*MZ4*dq1L*sin(q31L - q32L - q42L) + M3* ...
       M4*MZ3*MZ4*dq32L*sin(q31L - q32L - q42L) + M3*M4*MZ3*MZ4*dq42L* ...
       sin(q31L - q32L - q42L))/(M1 + 2*M3 + 2*M4);
C(2,1)=(L3^2*M4^2*dq1L*sin(q31L - q32L) + L3^2*M4^2*dq31L*sin(q31L - ...
        q32L) + M3^2*MY3^2*dq1L*sin(q31L - q32L) + M3^2*MY3^2*dq31L* ...
       sin(q31L - q32L) + M3^2*MZ3^2*dq1L*sin(q31L - q32L) + M3^2*MZ3^2* ...
       dq31L*sin(q31L - q32L) + M4^2*MY4^2*dq1L*sin(q31L - q32L + q41L - ...
        q42L) + M4^2*MY4^2*dq31L*sin(q31L - q32L + q41L - q42L) + M4^2* ...
       MY4^2*dq41L*sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq1L* ...
       sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq31L*sin(q31L - ...
        q32L + q41L - q42L) + M4^2*MZ4^2*dq41L*sin(q31L - q32L + q41L - ...
        q42L) - L3*M4^2*MY4*dq1L*cos(q31L - q32L + q41L) - L3*M4^2*MY4* ...
       dq31L*cos(q31L - q32L + q41L) - L3*M4^2*MY4*dq41L*cos(q31L - ...
        q32L + q41L) + L3*M4^2*MZ4*dq1L*sin(q31L - q32L + q41L) + L3* ...
       M4^2*MZ4*dq31L*sin(q31L - q32L + q41L) + L3*M4^2*MZ4*dq41L* ...
       sin(q31L - q32L + q41L) + L3*M4^2*MY4*dq1L*cos(q31L - q32L - ...
        q42L) + L3*M4^2*MY4*dq31L*cos(q31L - q32L - q42L) + L3*M4^2*MZ4* ...
       dq1L*sin(q31L - q32L - q42L) + L3*M4^2*MZ4*dq31L*sin(q31L - ...
        q32L - q42L) + 2*L3*M3*M4*MZ3*dq1L*sin(q31L - q32L) + 2*L3*M3* ...
       M4*MZ3*dq31L*sin(q31L - q32L) + M3*M4*MY3*MZ4*dq1L*cos(q31L - ...
        q32L + q41L) - M3*M4*MY4*MZ3*dq1L*cos(q31L - q32L + q41L) + M3* ...
       M4*MY3*MZ4*dq31L*cos(q31L - q32L + q41L) - M3*M4*MY4*MZ3*dq31L* ...
       cos(q31L - q32L + q41L) + M3*M4*MY3*MZ4*dq41L*cos(q31L - q32L + ...
        q41L) - M3*M4*MY4*MZ3*dq41L*cos(q31L - q32L + q41L) + M3*M4*MY3* ...
       MY4*dq1L*sin(q31L - q32L + q41L) + M3*M4*MY3*MY4*dq31L*sin(q31L - ...
        q32L + q41L) + M3*M4*MY3*MY4*dq41L*sin(q31L - q32L + q41L) + M3* ...
       M4*MZ3*MZ4*dq1L*sin(q31L - q32L + q41L) + M3*M4*MZ3*MZ4*dq31L* ...
       sin(q31L - q32L + q41L) + M3*M4*MZ3*MZ4*dq41L*sin(q31L - q32L + ...
        q41L) - M3*M4*MY3*MZ4*dq1L*cos(q31L - q32L - q42L) + M3*M4*MY4* ...
       MZ3*dq1L*cos(q31L - q32L - q42L) - M3*M4*MY3*MZ4*dq31L*cos(q31L - ...
        q32L - q42L) + M3*M4*MY4*MZ3*dq31L*cos(q31L - q32L - q42L) + M3* ...
       M4*MY3*MY4*dq1L*sin(q31L - q32L - q42L) + M3*M4*MY3*MY4*dq31L* ...
       sin(q31L - q32L - q42L) + M3*M4*MZ3*MZ4*dq1L*sin(q31L - q32L - ...
        q42L) + M3*M4*MZ3*MZ4*dq31L*sin(q31L - q32L - q42L))/(M1 + 2* ...
       M3 + 2*M4);
C(2,2)=(M4*dq42L*(L3*M1*MY4*cos(q42L) + 2*L3*M3*MY4*cos(q42L) + L3*M4* ...
       MY4*cos(q42L) + M3*MY3*MZ4*cos(q42L) - M3*MY4*MZ3*cos(q42L) - L3* ...
       M1*MZ4*sin(q42L) - 2*L3*M3*MZ4*sin(q42L) - L3*M4*MZ4*sin(q42L) + ...
        M3*MY3*MY4*sin(q42L) + M3*MZ3*MZ4*sin(q42L)))/(M1 + 2*M3 + 2*M4);
C(2,3)=(M4*(dq1L + dq31L + dq41L)*(M4*MY4^2*sin(q31L - q32L + q41L - ...
        q42L) + M4*MZ4^2*sin(q31L - q32L + q41L - q42L) - L3*M4*MY4* ...
       cos(q31L - q32L + q41L) + M3*MY3*MZ4*cos(q31L - q32L + q41L) - ...
        M3*MY4*MZ3*cos(q31L - q32L + q41L) + L3*M4*MZ4*sin(q31L - q32L + ...
        q41L) + M3*MY3*MY4*sin(q31L - q32L + q41L) + M3*MZ3*MZ4* ...
       sin(q31L - q32L + q41L)))/(M1 + 2*M3 + 2*M4);
C(2,4)=(M4*(dq1L + dq32L + dq42L)*(L3*M1*MY4*cos(q42L) + 2*L3*M3*MY4* ...
       cos(q42L) + L3*M4*MY4*cos(q42L) + M3*MY3*MZ4*cos(q42L) - M3*MY4* ...
       MZ3*cos(q42L) - L3*M1*MZ4*sin(q42L) - 2*L3*M3*MZ4*sin(q42L) - L3* ...
       M4*MZ4*sin(q42L) + M3*MY3*MY4*sin(q42L) + M3*MZ3*MZ4* ...
       sin(q42L)))/(M1 + 2*M3 + 2*M4);
C(2,5)=(L3^2*M4^2*dq1L*sin(q31L - q32L) + L3^2*M4^2*dq31L*sin(q31L - ...
        q32L) + M3^2*MY3^2*dq1L*sin(q31L - q32L) + M3^2*MY3^2*dq31L* ...
       sin(q31L - q32L) + M3^2*MZ3^2*dq1L*sin(q31L - q32L) + M3^2*MZ3^2* ...
       dq31L*sin(q31L - q32L) + M4^2*MY4^2*dq1L*sin(q31L - q32L + q41L - ...
        q42L) + M4^2*MY4^2*dq31L*sin(q31L - q32L + q41L - q42L) + M4^2* ...
       MY4^2*dq41L*sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq1L* ...
       sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq31L*sin(q31L - ...
        q32L + q41L - q42L) + M4^2*MZ4^2*dq41L*sin(q31L - q32L + q41L - ...
        q42L) - L3*M4^2*MY4*dq1L*cos(q31L - q32L + q41L) - L3*M4^2*MY4* ...
       dq31L*cos(q31L - q32L + q41L) - L3*M4^2*MY4*dq41L*cos(q31L - ...
        q32L + q41L) + L3*M4^2*MZ4*dq1L*sin(q31L - q32L + q41L) + L3* ...
       M4^2*MZ4*dq31L*sin(q31L - q32L + q41L) + L3*M4^2*MZ4*dq41L* ...
       sin(q31L - q32L + q41L) + L3*M4^2*MY4*dq42L*cos(q42L) + L3*M4^2* ...
       MY4*dq1L*cos(q31L - q32L - q42L) + L3*M4^2*MY4*dq31L*cos(q31L - ...
        q32L - q42L) - L3*M4^2*MZ4*dq42L*sin(q42L) + L3*M4^2*MZ4*dq1L* ...
       sin(q31L - q32L - q42L) + L3*M4^2*MZ4*dq31L*sin(q31L - q32L - ...
        q42L) + 2*L3*M3*M4*MZ3*dq1L*sin(q31L - q32L) + 2*L3*M3*M4*MZ3* ...
       dq31L*sin(q31L - q32L) + M3*M4*MY3*MZ4*dq1L*cos(q31L - q32L + ...
        q41L) - M3*M4*MY4*MZ3*dq1L*cos(q31L - q32L + q41L) + M3*M4*MY3* ...
       MZ4*dq31L*cos(q31L - q32L + q41L) - M3*M4*MY4*MZ3*dq31L* ...
       cos(q31L - q32L + q41L) + M3*M4*MY3*MZ4*dq41L*cos(q31L - q32L + ...
        q41L) - M3*M4*MY4*MZ3*dq41L*cos(q31L - q32L + q41L) + M3*M4*MY3* ...
       MY4*dq1L*sin(q31L - q32L + q41L) + M3*M4*MY3*MY4*dq31L*sin(q31L - ...
        q32L + q41L) + M3*M4*MY3*MY4*dq41L*sin(q31L - q32L + q41L) + M3* ...
       M4*MZ3*MZ4*dq1L*sin(q31L - q32L + q41L) + M3*M4*MZ3*MZ4*dq31L* ...
       sin(q31L - q32L + q41L) + M3*M4*MZ3*MZ4*dq41L*sin(q31L - q32L + ...
        q41L) - M1*M4*MY1*MZ4*dq1L*cos(q32L + q42L) + M1*M4*MY4*MZ1* ...
       dq1L*cos(q32L + q42L) - M1*M4*MY1*MY4*dq1L*sin(q32L + q42L) - M1* ...
       M4*MZ1*MZ4*dq1L*sin(q32L + q42L) - L3*M1*M4*MY1*dq1L*cos(q32L) + ...
        L3*M1*M4*MY4*dq42L*cos(q42L) + 2*L3*M3*M4*MY4*dq42L*cos(q42L) - ...
        M1*M3*MY1*MZ3*dq1L*cos(q32L) + M1*M3*MY3*MZ1*dq1L*cos(q32L) + ...
        M3*M4*MY3*MZ4*dq42L*cos(q42L) - M3*M4*MY4*MZ3*dq42L*cos(q42L) - ...
        M3*M4*MY3*MZ4*dq1L*cos(q31L - q32L - q42L) + M3*M4*MY4*MZ3*dq1L* ...
       cos(q31L - q32L - q42L) - M3*M4*MY3*MZ4*dq31L*cos(q31L - q32L - ...
        q42L) + M3*M4*MY4*MZ3*dq31L*cos(q31L - q32L - q42L) - L3*M1*M4* ...
       MZ1*dq1L*sin(q32L) - L3*M1*M4*MZ4*dq42L*sin(q42L) - 2*L3*M3*M4* ...
       MZ4*dq42L*sin(q42L) - M1*M3*MY1*MY3*dq1L*sin(q32L) + M3*M4*MY3* ...
       MY4*dq42L*sin(q42L) - M1*M3*MZ1*MZ3*dq1L*sin(q32L) + M3*M4*MZ3* ...
       MZ4*dq42L*sin(q42L) + M3*M4*MY3*MY4*dq1L*sin(q31L - q32L - ...
        q42L) + M3*M4*MY3*MY4*dq31L*sin(q31L - q32L - q42L) + M3*M4*MZ3* ...
       MZ4*dq1L*sin(q31L - q32L - q42L) + M3*M4*MZ3*MZ4*dq31L*sin(q31L - ...
        q32L - q42L))/(M1 + 2*M3 + 2*M4);
C(3,1)=-(M4*(dq1L + dq31L)*(L3*M1*MY4*cos(q41L) + 2*L3*M3*MY4* ...
       cos(q41L) + L3*M4*MY4*cos(q41L) + M3*MY3*MZ4*cos(q41L) - M3*MY4* ...
       MZ3*cos(q41L) - L3*M1*MZ4*sin(q41L) - 2*L3*M3*MZ4*sin(q41L) - L3* ...
       M4*MZ4*sin(q41L) + M3*MY3*MY4*sin(q41L) + M3*MZ3*MZ4* ...
       sin(q41L)))/(M1 + 2*M3 + 2*M4);
C(3,2)=-(M4^2*MY4^2*dq1L*sin(q31L - q32L + q41L - q42L) + M4^2*MY4^2* ...
       dq32L*sin(q31L - q32L + q41L - q42L) + M4^2*MY4^2*dq42L* ...
       sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq1L*sin(q31L - ...
        q32L + q41L - q42L) + M4^2*MZ4^2*dq32L*sin(q31L - q32L + q41L - ...
        q42L) + M4^2*MZ4^2*dq42L*sin(q31L - q32L + q41L - q42L) - L3* ...
       M4^2*MY4*dq1L*cos(q31L - q32L + q41L) - L3*M4^2*MY4*dq32L* ...
       cos(q31L - q32L + q41L) + L3*M4^2*MZ4*dq1L*sin(q31L - q32L + ...
        q41L) + L3*M4^2*MZ4*dq32L*sin(q31L - q32L + q41L) + M3*M4*MY3* ...
       MZ4*dq1L*cos(q31L - q32L + q41L) - M3*M4*MY4*MZ3*dq1L*cos(q31L - ...
        q32L + q41L) + M3*M4*MY3*MZ4*dq32L*cos(q31L - q32L + q41L) - M3* ...
       M4*MY4*MZ3*dq32L*cos(q31L - q32L + q41L) + M3*M4*MY3*MY4*dq1L* ...
       sin(q31L - q32L + q41L) + M3*M4*MY3*MY4*dq32L*sin(q31L - q32L + ...
        q41L) + M3*M4*MZ3*MZ4*dq1L*sin(q31L - q32L + q41L) + M3*M4*MZ3* ...
       MZ4*dq32L*sin(q31L - q32L + q41L))/(M1 + 2*M3 + 2*M4);
C(3,4)=-(M4^2*sin(q31L - q32L + q41L - q42L)*(MY4^2 + MZ4^2)*(dq1L + ...
        dq32L + dq42L))/(M1 + 2*M3 + 2*M4);
C(3,5)=-(M4^2*MY4^2*dq1L*sin(q31L - q32L + q41L - q42L) + M4^2*MY4^2* ...
       dq32L*sin(q31L - q32L + q41L - q42L) + M4^2*MY4^2*dq42L* ...
       sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq1L*sin(q31L - ...
        q32L + q41L - q42L) + M4^2*MZ4^2*dq32L*sin(q31L - q32L + q41L - ...
        q42L) + M4^2*MZ4^2*dq42L*sin(q31L - q32L + q41L - q42L) - L3* ...
       M4^2*MY4*dq1L*cos(q31L - q32L + q41L) - L3*M4^2*MY4*dq32L* ...
       cos(q31L - q32L + q41L) + L3*M4^2*MZ4*dq1L*sin(q31L - q32L + ...
        q41L) + L3*M4^2*MZ4*dq32L*sin(q31L - q32L + q41L) + L3*M4^2*MY4* ...
       dq1L*cos(q41L) + L3*M4^2*MY4*dq31L*cos(q41L) - L3*M4^2*MZ4*dq1L* ...
       sin(q41L) - L3*M4^2*MZ4*dq31L*sin(q41L) + M3*M4*MY3*MZ4*dq1L* ...
       cos(q31L - q32L + q41L) - M3*M4*MY4*MZ3*dq1L*cos(q31L - q32L + ...
        q41L) + M3*M4*MY3*MZ4*dq32L*cos(q31L - q32L + q41L) - M3*M4*MY4* ...
       MZ3*dq32L*cos(q31L - q32L + q41L) + M3*M4*MY3*MY4*dq1L*sin(q31L - ...
        q32L + q41L) + M3*M4*MY3*MY4*dq32L*sin(q31L - q32L + q41L) + M3* ...
       M4*MZ3*MZ4*dq1L*sin(q31L - q32L + q41L) + M3*M4*MZ3*MZ4*dq32L* ...
       sin(q31L - q32L + q41L) + M1*M4*MY1*MZ4*dq1L*cos(q31L + q41L) - ...
        M1*M4*MY4*MZ1*dq1L*cos(q31L + q41L) + M1*M4*MY1*MY4*dq1L* ...
       sin(q31L + q41L) + M1*M4*MZ1*MZ4*dq1L*sin(q31L + q41L) + L3*M1* ...
       M4*MY4*dq1L*cos(q41L) + 2*L3*M3*M4*MY4*dq1L*cos(q41L) + L3*M1*M4* ...
       MY4*dq31L*cos(q41L) + 2*L3*M3*M4*MY4*dq31L*cos(q41L) + M3*M4*MY3* ...
       MZ4*dq1L*cos(q41L) - M3*M4*MY4*MZ3*dq1L*cos(q41L) + M3*M4*MY3* ...
       MZ4*dq31L*cos(q41L) - M3*M4*MY4*MZ3*dq31L*cos(q41L) - L3*M1*M4* ...
       MZ4*dq1L*sin(q41L) - 2*L3*M3*M4*MZ4*dq1L*sin(q41L) - L3*M1*M4* ...
       MZ4*dq31L*sin(q41L) - 2*L3*M3*M4*MZ4*dq31L*sin(q41L) + M3*M4*MY3* ...
       MY4*dq1L*sin(q41L) + M3*M4*MY3*MY4*dq31L*sin(q41L) + M3*M4*MZ3* ...
       MZ4*dq1L*sin(q41L) + M3*M4*MZ3*MZ4*dq31L*sin(q41L))/(M1 + 2*M3 + ...
        2*M4);
C(4,1)=(M4^2*MY4^2*dq1L*sin(q31L - q32L + q41L - q42L) + M4^2*MY4^2* ...
       dq31L*sin(q31L - q32L + q41L - q42L) + M4^2*MY4^2*dq41L* ...
       sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq1L*sin(q31L - ...
        q32L + q41L - q42L) + M4^2*MZ4^2*dq31L*sin(q31L - q32L + q41L - ...
        q42L) + M4^2*MZ4^2*dq41L*sin(q31L - q32L + q41L - q42L) + L3* ...
       M4^2*MY4*dq1L*cos(q31L - q32L - q42L) + L3*M4^2*MY4*dq31L* ...
       cos(q31L - q32L - q42L) + L3*M4^2*MZ4*dq1L*sin(q31L - q32L - ...
        q42L) + L3*M4^2*MZ4*dq31L*sin(q31L - q32L - q42L) - M3*M4*MY3* ...
       MZ4*dq1L*cos(q31L - q32L - q42L) + M3*M4*MY4*MZ3*dq1L*cos(q31L - ...
        q32L - q42L) - M3*M4*MY3*MZ4*dq31L*cos(q31L - q32L - q42L) + M3* ...
       M4*MY4*MZ3*dq31L*cos(q31L - q32L - q42L) + M3*M4*MY3*MY4*dq1L* ...
       sin(q31L - q32L - q42L) + M3*M4*MY3*MY4*dq31L*sin(q31L - q32L - ...
        q42L) + M3*M4*MZ3*MZ4*dq1L*sin(q31L - q32L - q42L) + M3*M4*MZ3* ...
       MZ4*dq31L*sin(q31L - q32L - q42L))/(M1 + 2*M3 + 2*M4);
C(4,2)=-(M4*(dq1L + dq32L)*(L3*M1*MY4*cos(q42L) + 2*L3*M3*MY4* ...
       cos(q42L) + L3*M4*MY4*cos(q42L) + M3*MY3*MZ4*cos(q42L) - M3*MY4* ...
       MZ3*cos(q42L) - L3*M1*MZ4*sin(q42L) - 2*L3*M3*MZ4*sin(q42L) - L3* ...
       M4*MZ4*sin(q42L) + M3*MY3*MY4*sin(q42L) + M3*MZ3*MZ4* ...
       sin(q42L)))/(M1 + 2*M3 + 2*M4);
C(4,3)=(M4^2*sin(q31L - q32L + q41L - q42L)*(MY4^2 + MZ4^2)*(dq1L + ...
        dq31L + dq41L))/(M1 + 2*M3 + 2*M4);
C(4,5)=(M4^2*MY4^2*dq1L*sin(q31L - q32L + q41L - q42L) + M4^2*MY4^2* ...
       dq31L*sin(q31L - q32L + q41L - q42L) + M4^2*MY4^2*dq41L* ...
       sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq1L*sin(q31L - ...
        q32L + q41L - q42L) + M4^2*MZ4^2*dq31L*sin(q31L - q32L + q41L - ...
        q42L) + M4^2*MZ4^2*dq41L*sin(q31L - q32L + q41L - q42L) - L3* ...
       M4^2*MY4*dq1L*cos(q42L) - L3*M4^2*MY4*dq32L*cos(q42L) + L3*M4^2* ...
       MY4*dq1L*cos(q31L - q32L - q42L) + L3*M4^2*MY4*dq31L*cos(q31L - ...
        q32L - q42L) + L3*M4^2*MZ4*dq1L*sin(q42L) + L3*M4^2*MZ4*dq32L* ...
       sin(q42L) + L3*M4^2*MZ4*dq1L*sin(q31L - q32L - q42L) + L3*M4^2* ...
       MZ4*dq31L*sin(q31L - q32L - q42L) - M1*M4*MY1*MZ4*dq1L*cos(q32L + ...
        q42L) + M1*M4*MY4*MZ1*dq1L*cos(q32L + q42L) - M1*M4*MY1*MY4* ...
       dq1L*sin(q32L + q42L) - M1*M4*MZ1*MZ4*dq1L*sin(q32L + q42L) - L3* ...
       M1*M4*MY4*dq1L*cos(q42L) - 2*L3*M3*M4*MY4*dq1L*cos(q42L) - L3*M1* ...
       M4*MY4*dq32L*cos(q42L) - 2*L3*M3*M4*MY4*dq32L*cos(q42L) - M3*M4* ...
       MY3*MZ4*dq1L*cos(q42L) + M3*M4*MY4*MZ3*dq1L*cos(q42L) - M3*M4* ...
       MY3*MZ4*dq32L*cos(q42L) + M3*M4*MY4*MZ3*dq32L*cos(q42L) - M3*M4* ...
       MY3*MZ4*dq1L*cos(q31L - q32L - q42L) + M3*M4*MY4*MZ3*dq1L* ...
       cos(q31L - q32L - q42L) - M3*M4*MY3*MZ4*dq31L*cos(q31L - q32L - ...
        q42L) + M3*M4*MY4*MZ3*dq31L*cos(q31L - q32L - q42L) + L3*M1*M4* ...
       MZ4*dq1L*sin(q42L) + 2*L3*M3*M4*MZ4*dq1L*sin(q42L) + L3*M1*M4* ...
       MZ4*dq32L*sin(q42L) + 2*L3*M3*M4*MZ4*dq32L*sin(q42L) - M3*M4*MY3* ...
       MY4*dq1L*sin(q42L) - M3*M4*MY3*MY4*dq32L*sin(q42L) - M3*M4*MZ3* ...
       MZ4*dq1L*sin(q42L) - M3*M4*MZ3*MZ4*dq32L*sin(q42L) + M3*M4*MY3* ...
       MY4*dq1L*sin(q31L - q32L - q42L) + M3*M4*MY3*MY4*dq31L*sin(q31L - ...
        q32L - q42L) + M3*M4*MZ3*MZ4*dq1L*sin(q31L - q32L - q42L) + M3* ...
       M4*MZ3*MZ4*dq31L*sin(q31L - q32L - q42L))/(M1 + 2*M3 + 2*M4);
C(5,1)=(L3^2*M4^2*dq1L*sin(q31L - q32L) + L3^2*M4^2*dq31L*sin(q31L - ...
        q32L) + M3^2*MY3^2*dq1L*sin(q31L - q32L) + M3^2*MY3^2*dq31L* ...
       sin(q31L - q32L) + M3^2*MZ3^2*dq1L*sin(q31L - q32L) + M3^2*MZ3^2* ...
       dq31L*sin(q31L - q32L) + M4^2*MY4^2*dq1L*sin(q31L - q32L + q41L - ...
        q42L) + M4^2*MY4^2*dq31L*sin(q31L - q32L + q41L - q42L) + M4^2* ...
       MY4^2*dq41L*sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq1L* ...
       sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq31L*sin(q31L - ...
        q32L + q41L - q42L) + M4^2*MZ4^2*dq41L*sin(q31L - q32L + q41L - ...
        q42L) - L3*M4^2*MY4*dq1L*cos(q31L - q32L + q41L) - L3*M4^2*MY4* ...
       dq31L*cos(q31L - q32L + q41L) - L3*M4^2*MY4*dq41L*cos(q31L - ...
        q32L + q41L) + L3*M4^2*MZ4*dq1L*sin(q31L - q32L + q41L) + L3* ...
       M4^2*MZ4*dq31L*sin(q31L - q32L + q41L) + L3*M4^2*MZ4*dq41L* ...
       sin(q31L - q32L + q41L) + L3*M4^2*MY4*dq41L*cos(q41L) + L3*M4^2* ...
       MY4*dq1L*cos(q31L - q32L - q42L) + L3*M4^2*MY4*dq31L*cos(q31L - ...
        q32L - q42L) - L3*M4^2*MZ4*dq41L*sin(q41L) + L3*M4^2*MZ4*dq1L* ...
       sin(q31L - q32L - q42L) + L3*M4^2*MZ4*dq31L*sin(q31L - q32L - ...
        q42L) + 2*L3*M3*M4*MZ3*dq1L*sin(q31L - q32L) + 2*L3*M3*M4*MZ3* ...
       dq31L*sin(q31L - q32L) + M3*M4*MY3*MZ4*dq1L*cos(q31L - q32L + ...
        q41L) - M3*M4*MY4*MZ3*dq1L*cos(q31L - q32L + q41L) + M3*M4*MY3* ...
       MZ4*dq31L*cos(q31L - q32L + q41L) - M3*M4*MY4*MZ3*dq31L* ...
       cos(q31L - q32L + q41L) + M3*M4*MY3*MZ4*dq41L*cos(q31L - q32L + ...
        q41L) - M3*M4*MY4*MZ3*dq41L*cos(q31L - q32L + q41L) + M3*M4*MY3* ...
       MY4*dq1L*sin(q31L - q32L + q41L) + M3*M4*MY3*MY4*dq31L*sin(q31L - ...
        q32L + q41L) + M3*M4*MY3*MY4*dq41L*sin(q31L - q32L + q41L) + M3* ...
       M4*MZ3*MZ4*dq1L*sin(q31L - q32L + q41L) + M3*M4*MZ3*MZ4*dq31L* ...
       sin(q31L - q32L + q41L) + M3*M4*MZ3*MZ4*dq41L*sin(q31L - q32L + ...
        q41L) + M1*M4*MY1*MZ4*dq1L*cos(q31L + q41L) - M1*M4*MY4*MZ1* ...
       dq1L*cos(q31L + q41L) + M1*M4*MY1*MZ4*dq31L*cos(q31L + q41L) - ...
        M1*M4*MY4*MZ1*dq31L*cos(q31L + q41L) + M1*M4*MY1*MZ4*dq41L* ...
       cos(q31L + q41L) - M1*M4*MY4*MZ1*dq41L*cos(q31L + q41L) + M1*M4* ...
       MY1*MY4*dq1L*sin(q31L + q41L) + M1*M4*MY1*MY4*dq31L*sin(q31L + ...
        q41L) + M1*M4*MY1*MY4*dq41L*sin(q31L + q41L) + M1*M4*MZ1*MZ4* ...
       dq1L*sin(q31L + q41L) + M1*M4*MZ1*MZ4*dq31L*sin(q31L + q41L) + ...
        M1*M4*MZ1*MZ4*dq41L*sin(q31L + q41L) + L3*M1*M4*MY1*dq1L* ...
       cos(q31L) + L3*M1*M4*MY1*dq31L*cos(q31L) + L3*M1*M4*MY4*dq41L* ...
       cos(q41L) + 2*L3*M3*M4*MY4*dq41L*cos(q41L) + M1*M3*MY1*MZ3*dq1L* ...
       cos(q31L) - M1*M3*MY3*MZ1*dq1L*cos(q31L) + M1*M3*MY1*MZ3*dq31L* ...
       cos(q31L) - M1*M3*MY3*MZ1*dq31L*cos(q31L) + M3*M4*MY3*MZ4*dq41L* ...
       cos(q41L) - M3*M4*MY4*MZ3*dq41L*cos(q41L) - M3*M4*MY3*MZ4*dq1L* ...
       cos(q31L - q32L - q42L) + M3*M4*MY4*MZ3*dq1L*cos(q31L - q32L - ...
        q42L) - M3*M4*MY3*MZ4*dq31L*cos(q31L - q32L - q42L) + M3*M4*MY4* ...
       MZ3*dq31L*cos(q31L - q32L - q42L) + L3*M1*M4*MZ1*dq1L*sin(q31L) + ...
        L3*M1*M4*MZ1*dq31L*sin(q31L) - L3*M1*M4*MZ4*dq41L*sin(q41L) - 2* ...
       L3*M3*M4*MZ4*dq41L*sin(q41L) + M1*M3*MY1*MY3*dq1L*sin(q31L) + M1* ...
       M3*MY1*MY3*dq31L*sin(q31L) + M3*M4*MY3*MY4*dq41L*sin(q41L) + M1* ...
       M3*MZ1*MZ3*dq1L*sin(q31L) + M1*M3*MZ1*MZ3*dq31L*sin(q31L) + M3* ...
       M4*MZ3*MZ4*dq41L*sin(q41L) + M3*M4*MY3*MY4*dq1L*sin(q31L - q32L - ...
        q42L) + M3*M4*MY3*MY4*dq31L*sin(q31L - q32L - q42L) + M3*M4*MZ3* ...
       MZ4*dq1L*sin(q31L - q32L - q42L) + M3*M4*MZ3*MZ4*dq31L*sin(q31L - ...
        q32L - q42L))/(M1 + 2*M3 + 2*M4);
C(5,2)=-(L3^2*M4^2*dq1L*sin(q31L - q32L) + L3^2*M4^2*dq32L*sin(q31L - ...
        q32L) + M3^2*MY3^2*dq1L*sin(q31L - q32L) + M3^2*MY3^2*dq32L* ...
       sin(q31L - q32L) + M3^2*MZ3^2*dq1L*sin(q31L - q32L) + M3^2*MZ3^2* ...
       dq32L*sin(q31L - q32L) + M4^2*MY4^2*dq1L*sin(q31L - q32L + q41L - ...
        q42L) + M4^2*MY4^2*dq32L*sin(q31L - q32L + q41L - q42L) + M4^2* ...
       MY4^2*dq42L*sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq1L* ...
       sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq32L*sin(q31L - ...
        q32L + q41L - q42L) + M4^2*MZ4^2*dq42L*sin(q31L - q32L + q41L - ...
        q42L) - L3*M4^2*MY4*dq1L*cos(q31L - q32L + q41L) - L3*M4^2*MY4* ...
       dq32L*cos(q31L - q32L + q41L) + L3*M4^2*MZ4*dq1L*sin(q31L - ...
        q32L + q41L) + L3*M4^2*MZ4*dq32L*sin(q31L - q32L + q41L) - L3* ...
       M4^2*MY4*dq42L*cos(q42L) + L3*M4^2*MY4*dq1L*cos(q31L - q32L - ...
        q42L) + L3*M4^2*MY4*dq32L*cos(q31L - q32L - q42L) + L3*M4^2*MY4* ...
       dq42L*cos(q31L - q32L - q42L) + L3*M4^2*MZ4*dq42L*sin(q42L) + L3* ...
       M4^2*MZ4*dq1L*sin(q31L - q32L - q42L) + L3*M4^2*MZ4*dq32L* ...
       sin(q31L - q32L - q42L) + L3*M4^2*MZ4*dq42L*sin(q31L - q32L - ...
        q42L) + 2*L3*M3*M4*MZ3*dq1L*sin(q31L - q32L) + 2*L3*M3*M4*MZ3* ...
       dq32L*sin(q31L - q32L) + M3*M4*MY3*MZ4*dq1L*cos(q31L - q32L + ...
        q41L) - M3*M4*MY4*MZ3*dq1L*cos(q31L - q32L + q41L) + M3*M4*MY3* ...
       MZ4*dq32L*cos(q31L - q32L + q41L) - M3*M4*MY4*MZ3*dq32L* ...
       cos(q31L - q32L + q41L) + M3*M4*MY3*MY4*dq1L*sin(q31L - q32L + ...
        q41L) + M3*M4*MY3*MY4*dq32L*sin(q31L - q32L + q41L) + M3*M4*MZ3* ...
       MZ4*dq1L*sin(q31L - q32L + q41L) + M3*M4*MZ3*MZ4*dq32L*sin(q31L - ...
        q32L + q41L) - M1*M4*MY1*MZ4*dq1L*cos(q32L + q42L) + M1*M4*MY4* ...
       MZ1*dq1L*cos(q32L + q42L) - M1*M4*MY1*MZ4*dq32L*cos(q32L + ...
        q42L) + M1*M4*MY4*MZ1*dq32L*cos(q32L + q42L) - M1*M4*MY1*MZ4* ...
       dq42L*cos(q32L + q42L) + M1*M4*MY4*MZ1*dq42L*cos(q32L + q42L) - ...
        M1*M4*MY1*MY4*dq1L*sin(q32L + q42L) - M1*M4*MY1*MY4*dq32L* ...
       sin(q32L + q42L) - M1*M4*MY1*MY4*dq42L*sin(q32L + q42L) - M1*M4* ...
       MZ1*MZ4*dq1L*sin(q32L + q42L) - M1*M4*MZ1*MZ4*dq32L*sin(q32L + ...
        q42L) - M1*M4*MZ1*MZ4*dq42L*sin(q32L + q42L) - L3*M1*M4*MY1* ...
       dq1L*cos(q32L) - L3*M1*M4*MY1*dq32L*cos(q32L) - L3*M1*M4*MY4* ...
       dq42L*cos(q42L) - 2*L3*M3*M4*MY4*dq42L*cos(q42L) - M1*M3*MY1*MZ3* ...
       dq1L*cos(q32L) + M1*M3*MY3*MZ1*dq1L*cos(q32L) - M1*M3*MY1*MZ3* ...
       dq32L*cos(q32L) + M1*M3*MY3*MZ1*dq32L*cos(q32L) - M3*M4*MY3*MZ4* ...
       dq42L*cos(q42L) + M3*M4*MY4*MZ3*dq42L*cos(q42L) - M3*M4*MY3*MZ4* ...
       dq1L*cos(q31L - q32L - q42L) + M3*M4*MY4*MZ3*dq1L*cos(q31L - ...
        q32L - q42L) - M3*M4*MY3*MZ4*dq32L*cos(q31L - q32L - q42L) + M3* ...
       M4*MY4*MZ3*dq32L*cos(q31L - q32L - q42L) - M3*M4*MY3*MZ4*dq42L* ...
       cos(q31L - q32L - q42L) + M3*M4*MY4*MZ3*dq42L*cos(q31L - q32L - ...
        q42L) - L3*M1*M4*MZ1*dq1L*sin(q32L) - L3*M1*M4*MZ1*dq32L* ...
       sin(q32L) + L3*M1*M4*MZ4*dq42L*sin(q42L) + 2*L3*M3*M4*MZ4*dq42L* ...
       sin(q42L) - M1*M3*MY1*MY3*dq1L*sin(q32L) - M1*M3*MY1*MY3*dq32L* ...
       sin(q32L) - M3*M4*MY3*MY4*dq42L*sin(q42L) - M1*M3*MZ1*MZ3*dq1L* ...
       sin(q32L) - M1*M3*MZ1*MZ3*dq32L*sin(q32L) - M3*M4*MZ3*MZ4*dq42L* ...
       sin(q42L) + M3*M4*MY3*MY4*dq1L*sin(q31L - q32L - q42L) + M3*M4* ...
       MY3*MY4*dq32L*sin(q31L - q32L - q42L) + M3*M4*MY3*MY4*dq42L* ...
       sin(q31L - q32L - q42L) + M3*M4*MZ3*MZ4*dq1L*sin(q31L - q32L - ...
        q42L) + M3*M4*MZ3*MZ4*dq32L*sin(q31L - q32L - q42L) + M3*M4*MZ3* ...
       MZ4*dq42L*sin(q31L - q32L - q42L))/(M1 + 2*M3 + 2*M4);
C(5,3)=(M4*(dq1L + dq31L + dq41L)*(M4*MY4^2*sin(q31L - q32L + q41L - ...
        q42L) + M4*MZ4^2*sin(q31L - q32L + q41L - q42L) + L3*M1*MY4* ...
       cos(q41L) + 2*L3*M3*MY4*cos(q41L) + L3*M4*MY4*cos(q41L) + M3*MY3* ...
       MZ4*cos(q41L) - M3*MY4*MZ3*cos(q41L) - L3*M1*MZ4*sin(q41L) - 2* ...
       L3*M3*MZ4*sin(q41L) - L3*M4*MZ4*sin(q41L) + M3*MY3*MY4* ...
       sin(q41L) + M3*MZ3*MZ4*sin(q41L) - L3*M4*MY4*cos(q31L - q32L + ...
        q41L) + M3*MY3*MZ4*cos(q31L - q32L + q41L) - M3*MY4*MZ3* ...
       cos(q31L - q32L + q41L) + L3*M4*MZ4*sin(q31L - q32L + q41L) + M3* ...
       MY3*MY4*sin(q31L - q32L + q41L) + M3*MZ3*MZ4*sin(q31L - q32L + ...
        q41L) + M1*MY1*MZ4*cos(q31L + q41L) - M1*MY4*MZ1*cos(q31L + ...
        q41L) + M1*MY1*MY4*sin(q31L + q41L) + M1*MZ1*MZ4*sin(q31L + ...
        q41L)))/(M1 + 2*M3 + 2*M4);
C(5,4)=-(M4*(dq1L + dq32L + dq42L)*(M4*MY4^2*sin(q31L - q32L + q41L - ...
        q42L) + M4*MZ4^2*sin(q31L - q32L + q41L - q42L) - L3*M1*MY4* ...
       cos(q42L) - 2*L3*M3*MY4*cos(q42L) - L3*M4*MY4*cos(q42L) + L3*M4* ...
       MY4*cos(q31L - q32L - q42L) - M3*MY3*MZ4*cos(q42L) + M3*MY4*MZ3* ...
       cos(q42L) - M3*MY3*MZ4*cos(q31L - q32L - q42L) + M3*MY4*MZ3* ...
       cos(q31L - q32L - q42L) + L3*M1*MZ4*sin(q42L) + 2*L3*M3*MZ4* ...
       sin(q42L) + L3*M4*MZ4*sin(q42L) + L3*M4*MZ4*sin(q31L - q32L - ...
        q42L) - M3*MY3*MY4*sin(q42L) - M3*MZ3*MZ4*sin(q42L) + M3*MY3* ...
       MY4*sin(q31L - q32L - q42L) + M3*MZ3*MZ4*sin(q31L - q32L - ...
        q42L) - M1*MY1*MZ4*cos(q32L + q42L) + M1*MY4*MZ1*cos(q32L + ...
        q42L) - M1*MY1*MY4*sin(q32L + q42L) - M1*MZ1*MZ4*sin(q32L + ...
        q42L)))/(M1 + 2*M3 + 2*M4);
C(5,5)=(L3^2*M4^2*dq31L*sin(q31L - q32L) - L3^2*M4^2*dq32L*sin(q31L - ...
        q32L) + M3^2*MY3^2*dq31L*sin(q31L - q32L) - M3^2*MY3^2*dq32L* ...
       sin(q31L - q32L) + M3^2*MZ3^2*dq31L*sin(q31L - q32L) - M3^2* ...
       MZ3^2*dq32L*sin(q31L - q32L) + M4^2*MY4^2*dq31L*sin(q31L - q32L + ...
        q41L - q42L) - M4^2*MY4^2*dq32L*sin(q31L - q32L + q41L - q42L) + ...
        M4^2*MY4^2*dq41L*sin(q31L - q32L + q41L - q42L) - M4^2*MY4^2* ...
       dq42L*sin(q31L - q32L + q41L - q42L) + M4^2*MZ4^2*dq31L* ...
       sin(q31L - q32L + q41L - q42L) - M4^2*MZ4^2*dq32L*sin(q31L - ...
        q32L + q41L - q42L) + M4^2*MZ4^2*dq41L*sin(q31L - q32L + q41L - ...
        q42L) - M4^2*MZ4^2*dq42L*sin(q31L - q32L + q41L - q42L) - L3* ...
       M4^2*MY4*dq31L*cos(q31L - q32L + q41L) + L3*M4^2*MY4*dq32L* ...
       cos(q31L - q32L + q41L) - L3*M4^2*MY4*dq41L*cos(q31L - q32L + ...
        q41L) + L3*M4^2*MZ4*dq31L*sin(q31L - q32L + q41L) - L3*M4^2*MZ4* ...
       dq32L*sin(q31L - q32L + q41L) + L3*M4^2*MZ4*dq41L*sin(q31L - ...
        q32L + q41L) + L3*M4^2*MY4*dq41L*cos(q41L) + L3*M4^2*MY4*dq42L* ...
       cos(q42L) + L3*M4^2*MY4*dq31L*cos(q31L - q32L - q42L) - L3*M4^2* ...
       MY4*dq32L*cos(q31L - q32L - q42L) - L3*M4^2*MY4*dq42L*cos(q31L - ...
        q32L - q42L) - L3*M4^2*MZ4*dq41L*sin(q41L) - L3*M4^2*MZ4*dq42L* ...
       sin(q42L) + L3*M4^2*MZ4*dq31L*sin(q31L - q32L - q42L) - L3*M4^2* ...
       MZ4*dq32L*sin(q31L - q32L - q42L) - L3*M4^2*MZ4*dq42L*sin(q31L - ...
        q32L - q42L) + 2*L3*M3*M4*MZ3*dq31L*sin(q31L - q32L) - 2*L3*M3* ...
       M4*MZ3*dq32L*sin(q31L - q32L) + M3*M4*MY3*MZ4*dq31L*cos(q31L - ...
        q32L + q41L) - M3*M4*MY4*MZ3*dq31L*cos(q31L - q32L + q41L) - M3* ...
       M4*MY3*MZ4*dq32L*cos(q31L - q32L + q41L) + M3*M4*MY4*MZ3*dq32L* ...
       cos(q31L - q32L + q41L) + M3*M4*MY3*MZ4*dq41L*cos(q31L - q32L + ...
        q41L) - M3*M4*MY4*MZ3*dq41L*cos(q31L - q32L + q41L) + M3*M4*MY3* ...
       MY4*dq31L*sin(q31L - q32L + q41L) - M3*M4*MY3*MY4*dq32L* ...
       sin(q31L - q32L + q41L) + M3*M4*MY3*MY4*dq41L*sin(q31L - q32L + ...
        q41L) + M3*M4*MZ3*MZ4*dq31L*sin(q31L - q32L + q41L) - M3*M4*MZ3* ...
       MZ4*dq32L*sin(q31L - q32L + q41L) + M3*M4*MZ3*MZ4*dq41L* ...
       sin(q31L - q32L + q41L) + M1*M4*MY1*MZ4*dq31L*cos(q31L + q41L) - ...
        M1*M4*MY4*MZ1*dq31L*cos(q31L + q41L) + M1*M4*MY1*MZ4*dq32L* ...
       cos(q32L + q42L) - M1*M4*MY4*MZ1*dq32L*cos(q32L + q42L) + M1*M4* ...
       MY1*MZ4*dq41L*cos(q31L + q41L) - M1*M4*MY4*MZ1*dq41L*cos(q31L + ...
        q41L) + M1*M4*MY1*MZ4*dq42L*cos(q32L + q42L) - M1*M4*MY4*MZ1* ...
       dq42L*cos(q32L + q42L) + M1*M4*MY1*MY4*dq31L*sin(q31L + q41L) + ...
        M1*M4*MY1*MY4*dq32L*sin(q32L + q42L) + M1*M4*MY1*MY4*dq41L* ...
       sin(q31L + q41L) + M1*M4*MY1*MY4*dq42L*sin(q32L + q42L) + M1*M4* ...
       MZ1*MZ4*dq31L*sin(q31L + q41L) + M1*M4*MZ1*MZ4*dq32L*sin(q32L + ...
        q42L) + M1*M4*MZ1*MZ4*dq41L*sin(q31L + q41L) + M1*M4*MZ1*MZ4* ...
       dq42L*sin(q32L + q42L) + L3*M1*M4*MY1*dq31L*cos(q31L) + L3*M1*M4* ...
       MY1*dq32L*cos(q32L) + L3*M1*M4*MY4*dq41L*cos(q41L) + L3*M1*M4* ...
       MY4*dq42L*cos(q42L) + 2*L3*M3*M4*MY4*dq41L*cos(q41L) + 2*L3*M3* ...
       M4*MY4*dq42L*cos(q42L) + M1*M3*MY1*MZ3*dq31L*cos(q31L) - M1*M3* ...
       MY3*MZ1*dq31L*cos(q31L) + M1*M3*MY1*MZ3*dq32L*cos(q32L) - M1*M3* ...
       MY3*MZ1*dq32L*cos(q32L) + M3*M4*MY3*MZ4*dq41L*cos(q41L) - M3*M4* ...
       MY4*MZ3*dq41L*cos(q41L) + M3*M4*MY3*MZ4*dq42L*cos(q42L) - M3*M4* ...
       MY4*MZ3*dq42L*cos(q42L) - M3*M4*MY3*MZ4*dq31L*cos(q31L - q32L - ...
        q42L) + M3*M4*MY4*MZ3*dq31L*cos(q31L - q32L - q42L) + M3*M4*MY3* ...
       MZ4*dq32L*cos(q31L - q32L - q42L) - M3*M4*MY4*MZ3*dq32L* ...
       cos(q31L - q32L - q42L) + M3*M4*MY3*MZ4*dq42L*cos(q31L - q32L - ...
        q42L) - M3*M4*MY4*MZ3*dq42L*cos(q31L - q32L - q42L) + L3*M1*M4* ...
       MZ1*dq31L*sin(q31L) + L3*M1*M4*MZ1*dq32L*sin(q32L) - L3*M1*M4* ...
       MZ4*dq41L*sin(q41L) - L3*M1*M4*MZ4*dq42L*sin(q42L) - 2*L3*M3*M4* ...
       MZ4*dq41L*sin(q41L) - 2*L3*M3*M4*MZ4*dq42L*sin(q42L) + M1*M3*MY1* ...
       MY3*dq31L*sin(q31L) + M1*M3*MY1*MY3*dq32L*sin(q32L) + M3*M4*MY3* ...
       MY4*dq41L*sin(q41L) + M3*M4*MY3*MY4*dq42L*sin(q42L) + M1*M3*MZ1* ...
       MZ3*dq31L*sin(q31L) + M1*M3*MZ1*MZ3*dq32L*sin(q32L) + M3*M4*MZ3* ...
       MZ4*dq41L*sin(q41L) + M3*M4*MZ3*MZ4*dq42L*sin(q42L) + M3*M4*MY3* ...
       MY4*dq31L*sin(q31L - q32L - q42L) - M3*M4*MY3*MY4*dq32L* ...
       sin(q31L - q32L - q42L) - M3*M4*MY3*MY4*dq42L*sin(q31L - q32L - ...
        q42L) + M3*M4*MZ3*MZ4*dq31L*sin(q31L - q32L - q42L) - M3*M4*MZ3* ...
       MZ4*dq32L*sin(q31L - q32L - q42L) - M3*M4*MZ3*MZ4*dq42L* ...
       sin(q31L - q32L - q42L))/(M1 + 2*M3 + 2*M4);

% G matrix
G=zeros(7,1);
G(7)=g*(M1 + 2*M3 + 2*M4);

% B matrix
B=zeros(7,4);
B(1,1)=1;
B(2,2)=1;
B(3,3)=1;
B(4,4)=1;

E1=zeros(7,4);
E1(1,1)=(M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*cos(q31L + q41L + q1L) - L3*cos(q31L + q1L);
E1(1,2)=(M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) - M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*sin(q31L + q41L + q1L) - L3*sin(q31L + q1L);
E1(1,3)=(M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4);
E1(1,4)=(M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) - M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L)))/(M1 + 2*M3 + 2*M4);
E1(2,1)=(M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4);
E1(2,2)=(M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L)))/(M1 + 2*M3 + 2*M4);
E1(2,3)=(M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*cos(q32L + q42L + q1L) - L3*cos(q32L + q1L);
E1(2,4)=(M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*sin(q32L + q42L + q1L) - L3*sin(q32L + q1L);
E1(3,1)=(M4*(MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*cos(q31L + q41L + q1L);
E1(3,2)=- L4*sin(q31L + q41L + q1L) - (M4*(MY4*cos(q31L + q41L + q1L) - MZ4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4);
E1(3,3)=(M4*(MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4);
E1(3,4)=-(M4*(MY4*cos(q31L + q41L + q1L) - MZ4*sin(q31L + q41L + q1L)))/(M1 + 2*M3 + 2*M4);
E1(4,1)=(M4*(MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4);
E1(4,2)=-(M4*(MY4*cos(q32L + q42L + q1L) - MZ4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4);
E1(4,3)=(M4*(MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*cos(q32L + q42L + q1L);
E1(4,4)=- L4*sin(q32L + q42L + q1L) - (M4*(MY4*cos(q32L + q42L + q1L) - MZ4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4);
E1(5,1)=(M1*(MZ1*cos(q1L) + MY1*sin(q1L)) + M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4) - L3*cos(q31L + q1L) - L4*cos(q31L + q41L + q1L);
E1(5,2)=- L3*sin(q31L + q1L) - (M1*(MY1*cos(q1L) - MZ1*sin(q1L)) - M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) + M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L)) + M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*sin(q31L + q41L + q1L);
E1(5,3)=(M1*(MZ1*cos(q1L) + MY1*sin(q1L)) + M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + q41L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4*cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4) - L3*cos(q32L + q1L) - L4*cos(q32L + q42L + q1L);
E1(5,4)=- L3*sin(q32L + q1L) - (M1*(MY1*cos(q1L) - MZ1*sin(q1L)) - M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + q1L)) - M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) + M3*(MY3*cos(q31L + q1L) - MZ3*sin(q31L + q1L)) + M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L)))/(M1 + 2*M3 + 2*M4) - L4*sin(q32L + q42L + q1L);
E1(6,1)=1;
E1(6,3)=1;
E1(7,2)=1;
E1(7,4)=1;