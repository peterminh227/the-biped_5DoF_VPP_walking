function [vh,vv] = stance_foot_vel(x)
% STANCE_FOOT_VEL
%   [VH,VV] = STANCE_FOOT_VEL(X)  

%Eric Westervelt
%2016 Version: Peter Minh
%02-Dec-2016 03:18:00

modelP;

q31L=x(1);q32L=x(2);q41L=x(3);q42L=x(4);q1L=x(5); ycm=x(6);zcm=x(7);
dq31L=x(8);dq32L=x(9);dq41L=x(10);dq42L=x(11);dq1L=x(12); dycm=x(13);dzcm=x(14);

vh = dycm - dq31L*(L3*cos(q31L + q1L) + L4*cos(q31L + q41L + q1L) - ...
     (M3*(MZ3*cos(q31L + q1L) + MY3*sin(q31L + q1L)) + M4*(L3* ...
    cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + ...
     q41L + q1L)))/(M1 + 2*M3 + 2*M4)) - dq1L*(L3*cos(q31L + q1L) - ...
     (M1*(MZ1*cos(q1L) + MY1*sin(q1L)) + M3*(MZ3*cos(q31L + q1L) + ...
     MY3*sin(q31L + q1L)) + M3*(MZ3*cos(q32L + q1L) + MY3*sin(q32L + ...
     q1L)) + M4*(L3*cos(q31L + q1L) + MZ4*cos(q31L + q41L + q1L) + ...
     MY4*sin(q31L + q41L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4* ...
    cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L)))/(M1 + 2* ...
    M3 + 2*M4) + L4*cos(q31L + q41L + q1L)) - dq41L*(L4*cos(q31L + ...
     q41L + q1L) - (M4*(MZ4*cos(q31L + q41L + q1L) + MY4*sin(q31L + ...
     q41L + q1L)))/(M1 + 2*M3 + 2*M4)) + (dq32L*(M3*(MZ3*cos(q32L + ...
     q1L) + MY3*sin(q32L + q1L)) + M4*(L3*cos(q32L + q1L) + MZ4* ...
    cos(q32L + q42L + q1L) + MY4*sin(q32L + q42L + q1L))))/(M1 + 2* ...
    M3 + 2*M4) + (M4*dq42L*(MZ4*cos(q32L + q42L + q1L) + MY4* ...
    sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4);
vv = dzcm - dq1L*(L3*sin(q31L + q1L) + (M1*(MY1*cos(q1L) - MZ1* ...
    sin(q1L)) - M4*(L3*sin(q32L + q1L) - MY4*cos(q32L + q42L + q1L) + ...
     MZ4*sin(q32L + q42L + q1L)) - M4*(L3*sin(q31L + q1L) - MY4* ...
    cos(q31L + q41L + q1L) + MZ4*sin(q31L + q41L + q1L)) + M3*(MY3* ...
    cos(q31L + q1L) - MZ3*sin(q31L + q1L)) + M3*(MY3*cos(q32L + ...
     q1L) - MZ3*sin(q32L + q1L)))/(M1 + 2*M3 + 2*M4) + L4*sin(q31L + ...
     q41L + q1L)) - dq31L*(L3*sin(q31L + q1L) + L4*sin(q31L + q41L + ...
     q1L) - (M4*(L3*sin(q31L + q1L) - MY4*cos(q31L + q41L + q1L) + ...
     MZ4*sin(q31L + q41L + q1L)) - M3*(MY3*cos(q31L + q1L) - MZ3* ...
    sin(q31L + q1L)))/(M1 + 2*M3 + 2*M4)) - dq41L*(L4*sin(q31L + ...
     q41L + q1L) + (M4*(MY4*cos(q31L + q41L + q1L) - MZ4*sin(q31L + ...
     q41L + q1L)))/(M1 + 2*M3 + 2*M4)) + (dq32L*(M4*(L3*sin(q32L + ...
     q1L) - MY4*cos(q32L + q42L + q1L) + MZ4*sin(q32L + q42L + ...
     q1L)) - M3*(MY3*cos(q32L + q1L) - MZ3*sin(q32L + q1L))))/(M1 + ...
     2*M3 + 2*M4) - (M4*dq42L*(MY4*cos(q32L + q42L + q1L) - MZ4* ...
    sin(q32L + q42L + q1L)))/(M1 + 2*M3 + 2*M4);
